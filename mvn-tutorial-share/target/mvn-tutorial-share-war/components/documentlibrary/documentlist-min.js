(function(){var z=YAHOO.util.Dom,N=YAHOO.util.Event,L=YAHOO.util.DragDropMgr;var f=Alfresco.util.encodeHTML,aj=Alfresco.util.activateLinks,aH=Alfresco.util.combinePaths,n=Alfresco.util.userProfileLink,b=Alfresco.util.siteURL,M=function M(a1,a2){return Alfresco.util.formatDate(Alfresco.util.fromISO8601(a1),a2)},aa=Alfresco.util.relativeTime,E=Alfresco.util.isValueSet;var aT="org.alfresco.share.documentList",aD=aT+".sortAscending",d=aT+".sortField",X=aT+".showFolders",D=aT+".hideNavBar",R=aT+".simpleView",Y=aT+".viewRendererName",at=aT+".galleryColumns";Alfresco.DnD=function(a5,a2,a1,a3){Alfresco.DnD.superclass.constructor.call(this,a5,a1,a3);var a4=this.getDragEl();z.setStyle(a4,"opacity",0.67);this.docLib=a2};YAHOO.extend(Alfresco.DnD,YAHOO.util.DDProxy,{_inFlight:false,startDrag:function p(a2,a5){var a1=this.getDragEl();var a4=this.getEl();z.setStyle(a4,"visibility","hidden");var a3=document.createElement("img");a3.src=a4.src;a1.removeChild(a1.firstChild);a1.appendChild(a3);z.setStyle(a1,"border","none")},endDrag:function ah(a3){if(!this._inFlight){var a1=this.getEl();var a2=this.getDragEl();this.animateResult(a2,a1)}},animateResult:function ap(a4,a1){z.setStyle(a4,"visibility","");var a2=new YAHOO.util.Motion(a4,{points:{to:z.getXY(a1)}},0.2,YAHOO.util.Easing.easeOut);var a3=a4.id;var a5=this.id;a2.onComplete.subscribe(function(){z.setStyle(a3,"visibility","hidden");z.setStyle(a5,"visibility","")});a2.animate()},onDragDrop:function t(a5,a7){var a6=z.get(a7);if(L.interactionInfo.drop.length>0){if(z.isAncestor(this.docLib.widgets.dataTable.getContainerEl(),a6)){var a1=this.docLib.widgets.dataTable.getRecord(z.get(a7)),a4=a1.getData();if(a4.node.isContainer){this._inFlight=true;var a2;if(a4.node.isLink){a2=new Alfresco.util.NodeRef(a4.node.linkedNode.nodeRef)}else{a2=new Alfresco.util.NodeRef(a4.node.nodeRef)}this._performMove(a2,a4.location.path+"/"+a4.location.file)}}else{if(z.hasClass(a6,"documentDroppable")){var a3={elementId:a7,callback:this.onDropTargetOwnerCallBack,scope:this};this._inFlight=true;YAHOO.Bubbling.fire("dropTargetOwnerRequest",a3);this._setFailureTimeout()}}}},_performMove:function ao(a6,a9){var a3=this.docLib.widgets.dataTable.getRecord(this.getEl()),a4="move-to/node/{nodeRef}",a8=[];a8.push(this.getEl().id);var a7=function a5(bc){this._inFlight=false;var ba,bd=bc.json.successCount,be=bc.json.failureCount;if(!bc.json.overallSuccess){this.animateResult(this.getDragEl(),this.getEl());Alfresco.util.PopupManager.displayMessage({text:this.docLib.msg("message.file-dnd-move.failure")});z.removeClass(this.dragFolderHighlight,"dndFolderHighlight");return}this.docLib._updateDocList.call(this.docLib);var bb=a3.getData();if(bb.node.isContainer){YAHOO.Bubbling.fire("folderMoved",{multiple:true,nodeRef:bb.nodeRef,destination:a9})}};var a2=function a1(ba){this._inFlight=false;this.animateResult(this.getDragEl(),this.getEl());Alfresco.util.PopupManager.displayMessage({text:this.docLib.msg("message.file-dnd-move.failure")});z.removeClass(this.dragFolderHighlight,"dndFolderHighlight")};this.docLib.modules.actions.genericAction({success:{callback:{fn:a7,scope:this}},failure:{callback:{fn:a2,scope:this}},webscript:{method:Alfresco.util.Ajax.POST,name:a4,params:{nodeRef:a6.uri}},wait:{message:this.docLib.msg("message.please-wait")},config:{requestContentType:Alfresco.util.Ajax.JSON,dataObj:{nodeRefs:a8,parentId:this.docLib.doclistMetadata.parent.nodeRef}}})},_currTimeoutId:null,onDropTargetOwnerCallBack:function au(a1,a3){this._clearTimeout();var a2=new Alfresco.util.NodeRef(a1);this._performMove(a2,a3)},_clearTimeout:function ai(){if(this._currTimeoutId!=null){window.clearTimeout(this._currTimeoutId);this._currTimeoutId=null;this._inFlight=false}},_setFailureTimeout:function aK(){this._clearTimeout();var a1=this;this._currTimeoutId=window.setTimeout(function(){a1.animateResult(a1.getDragEl(),a1.getEl());a1._inFlight=false;a1._currTimeoutId=null},500)},onDragOver:function aW(a3,a4){var a1=z.get(a4);if(a1.tagName=="IMG"||a1.className=="droppable"){this.dragFolderHighlight=z.getAncestorByClassName(a1,"folder");z.addClass(this.dragFolderHighlight,"dndFolderHighlight")}else{if(z.hasClass(a1,"documentDroppableHighlights")){var a2={elementId:a4,event:a3};YAHOO.Bubbling.fire("documentDragOver",a2)}}},onDragOut:function aL(a3,a4){var a1=z.get(a4);if(a1.tagName=="IMG"||a1.className=="droppable"){this.dragFolderHighlight=z.getAncestorByClassName(a1,"folder");z.removeClass(this.dragFolderHighlight,"dndFolderHighlight")}else{if(z.hasClass(a1,"documentDroppableHighlights")){var a2={elementId:a4,event:a3};YAHOO.Bubbling.fire("documentDragOut",a2)}}}});Alfresco.DocumentList=function(a1){Alfresco.DocumentList.superclass.constructor.call(this,"Alfresco.DocumentList",a1,["button","menu","container","datasource","datatable","paginator","json","history"]);this.currentPath="";this.currentPage=1;this.totalRecords=0;this.totalRecordsUpper=null;this.hideMoreActionsFn=null;this.state={actionEditOfflineActive:false};this.currentFilter={filterId:"path",filterData:""};this.actions={};this.selectedFiles={};this.afterDocListUpdate=[];this.doclistMetadata={};this.previewTooltips=[];this.insituEditors=[];this.dynamicControls=[];this.sortControls=[];this.dragAndDropAllowed=true;this.dragAndDropEnabled=false;this.dragEventRefCount=0;this.actionsView="browse";this.renderers={};this.viewRenderers={};this.dataSourceUrl=aH(Alfresco.constants.URL_SERVICECONTEXT,"components/documentlibrary/data/doclist/");YAHOO.Bubbling.on("activateDynamicControls",this.onActivateDynamicControls,this);YAHOO.Bubbling.on("activateSortControls",this.onActivateSortControls,this);YAHOO.Bubbling.on("deactivateAllControls",this.onDeactivateAllControls,this);YAHOO.Bubbling.on("deactivateDynamicControls",this.onDeactivateDynamicControls,this);YAHOO.Bubbling.on("deactivateSortControls",this.onDeactivateSortControls,this);YAHOO.Bubbling.on("metadataRefresh",this.onDocListRefresh,this);YAHOO.Bubbling.on("fileRenamed",this.onFileRenamed,this);YAHOO.Bubbling.on("changeFilter",this.onChangeFilter,this);YAHOO.Bubbling.on("filterChanged",this.onFilterChanged,this);YAHOO.Bubbling.on("folderCreated",this.onDocListRefresh,this);YAHOO.Bubbling.on("nodeCreated",this.onDocListRefresh,this);YAHOO.Bubbling.on("folderRenamed",this.onFileRenamed,this);YAHOO.Bubbling.on("highlightFile",this.onHighlightFile,this);YAHOO.Bubbling.on("registerRenderer",this.onRegisterRenderer,this);YAHOO.Bubbling.on("registerViewRenderer",this.onRegisterViewRenderer,this);YAHOO.Bubbling.on("registerAction",this.onRegisterAction,this);YAHOO.Bubbling.on("resizerChanged",this.onResizerChanged,this);YAHOO.Bubbling.on("fileCopied",this.onFileAction,this);YAHOO.Bubbling.on("fileDeleted",this.onFileAction,this);YAHOO.Bubbling.on("fileMoved",this.onFileAction,this);YAHOO.Bubbling.on("filePermissionsUpdated",this.onFileAction,this);YAHOO.Bubbling.on("folderCopied",this.onFileAction,this);YAHOO.Bubbling.on("folderDeleted",this.onFileAction,this);YAHOO.Bubbling.on("folderMoved",this.onFileAction,this);YAHOO.Bubbling.on("folderPermissionsUpdated",this.onFileAction,this);YAHOO.Bubbling.on("filesCopied",this.onDocListRefresh,this);YAHOO.Bubbling.on("filesDeleted",this.onDocListRefresh,this);YAHOO.Bubbling.on("filesMoved",this.onDocListRefresh,this);YAHOO.Bubbling.on("filesPermissionsUpdated",this.onDocListRefresh,this);return this};YAHOO.extend(Alfresco.DocumentList,Alfresco.component.Base);YAHOO.lang.augmentProto(Alfresco.DocumentList,Alfresco.doclib.Actions);Alfresco.DocumentList.generateFilterMarkup=function u(a1){var a2=Alfresco.util.cleanBubblingObject(a1);return YAHOO.lang.substitute("{filterOwner}|{filterId}|{filterData}|{filterDisplay}",a2,function(a4,a5,a3){return typeof a5==="undefined"?"":window.escape(a5)})};Alfresco.DocumentList.generatePathMarkup=function ak(a1){return Alfresco.DocumentList.generateFilterMarkup({filterId:"path",filterData:aH(a1.path,a1.file)})};Alfresco.DocumentList.generateCategoryMarkup=function j(a1){return Alfresco.DocumentList.generateFilterMarkup({filterId:"category",filterData:aH(a1[1],a1[0])})};Alfresco.DocumentList.generateFileFolderLinkMarkup=function h(a3,a1){var a5=a1.jsNode,a2;if(a5.isLink&&E(a3.options.siteId)&&a1.location.site&&a1.location.site.name!==a3.options.siteId){if(a5.isContainer){a2=b("documentlibrary?path="+encodeURIComponent(a1.location.path),{site:a1.location.site.name})}else{a2=a3.getActionUrls(a1,a1.location.site.name).documentDetailsUrl}}else{if(a5.isContainer){if(a1.parent.isContainer){a2='#" class="filter-change" rel="'+Alfresco.DocumentList.generatePathMarkup(a1.location)}else{if(a1.location.path==="/"){a2='#" class="filter-change" rel="'+Alfresco.DocumentList.generateFilterMarkup({filterId:"path",filterData:aH(a1.location.path,"")})}else{a2="#"}}}else{var a4=a3.getActionUrls(a1);if(a5.isLink&&a5.linkedNode.isContainer){a2=a4.folderDetailsUrl}else{a2=a4.documentDetailsUrl}}}return'<a href="'+a2+'">'};Alfresco.DocumentList.generateThumbnailUrl=function ac(a1,a4){var a3=a1.jsNode,a2=a3.isLink?a3.linkedNode.nodeRef:a3.nodeRef;if(a4==null){a4="doclib"}return Alfresco.util.generateThumbnailUrl(a3,a4)};Alfresco.DocumentList.generateFavourite=function aI(a3,a1){var a4=a1.jsNode,a5="favourite."+(a4.isContainer?"folder.":"document."),a2="";if(a1.isFavourite){a2='<a class="favourite-action enabled" title="'+a3.msg(a5+"remove.tip")+'" tabindex="0"></a>'}else{a2='<a class="favourite-action" title="'+a3.msg(a5+"add.tip")+'" tabindex="0">'+a3.msg(a5+"add.label")+"</a>"}return a2};Alfresco.DocumentList.generateLikes=function q(a4,a1){var a5=a1.node,a2=a1.likes,a6="like."+(a5.isContainer?"folder.":"document."),a3="";if(a2.isLiked){a3='<a class="like-action enabled" title="'+a4.msg(a6+"remove.tip")+'" tabindex="0"></a>'}else{a3='<a class="like-action" title="'+a4.msg(a6+"add.tip")+'" tabindex="0">'+a4.msg(a6+"add.label")+"</a>"}a3+='<span class="likes-count">'+f(a2.totalLikes)+"</span>";return a3};Alfresco.DocumentList.generateComments=function aM(a4,a1){var a7=a1.node,a6=a4.getActionUrls(a1),a2=a6[a7.isContainer?"folderDetailsUrl":"documentDetailsUrl"]+"#comment",a8="comment."+(a7.isContainer?"folder.":"document.");var a5=(a7.properties["fm:commentCount"]!==undefined);var a3='<a href="'+a2+'" class="comment'+(a5?" hasComments":"")+'" title="'+a4.msg(a8+"tip")+'" tabindex="0">'+a4.msg(a8+"label")+"</a>";if(a5){a3+='<span class="comment-count">'+f(a7.properties["fm:commentCount"])+"</span>"}return a3};Alfresco.DocumentList.generateQuickShare=function w(a2,a1){return new Alfresco.QuickShare().setOptions({nodeRef:a1.jsNode.nodeRef,displayName:a1.displayName}).display(a1.jsNode.properties.qshare_sharedId,a1.jsNode.properties.qshare_sharedBy)};Alfresco.DocumentList.generateUserLink=function aQ(a2,a1){if(a1.isDeleted===true){return"<span>"+a2.msg("details.user.deleted",f(a1.userName))+"</span>"}return n(a1.userName,YAHOO.lang.trim(a1.firstName+" "+a1.lastName))};YAHOO.lang.augmentObject(Alfresco.DocumentList.prototype,{options:{sortAscending:true,showFolders:false,simpleView:null,viewRendererName:"detailed",viewRendererNames:["simple","detailed","gallery"],viewRenderers:[],usePagination:false,siteId:"",containerId:"documentLibrary",rootNode:null,initialPage:1,pageSize:50,initialFilter:{},loadingMessageDelay:1000,highlightFile:null,previewTooltips:null,insituEditors:null,groupActivitiesAt:5,inlineEditMimetypes:{"text/plain":true,"text/html":true,"text/xml":true},replicationUrlMapping:{},listUpdated:false,repositoryBrowsing:true,useTitle:true,userIsSiteManager:false,actionsSplitAt:3},state:{actionEditOfflineActive:false},currentPath:null,currentPage:null,totalRecords:null,currentFilter:null,fileUpload:null,actions:null,selectedFiles:null,currentActionsMenu:null,hideMoreActionsFn:null,afterDocListUpdate:null,doclistMetadata:null,dynamicControls:null,sortControls:null,dragAndDropAllowed:null,dragAndDropEnabled:null,dragEventRefCount:null,dragFolderHighlight:null,renderers:null,viewRenderers:null,_userCanUpload:false,onReady:function U(){var be=this;this.dragAndDropEnabled=this.dragAndDropAllowed&&("draggable" in document.createElement("span"))&&YAHOO.env.ua.mobile===null;var a8=false;var a4=1;for(var a6=0,bh=this.options.viewRendererNames.length;a6<bh;a6++){if(this.options.viewRendererNames[a6]===this.options.viewRendererName){a8=true;a4=a6;break}}if(!a8&&this.options.viewRendererNames.length>0){this.options.viewRendererName=this.options.viewRendererNames[0]}this.userPreferredView=this.options.viewRendererName;this._setupMetadataRenderers();this._setupHistoryManagers();if(z.get(this.id+"-doclistBar")){this.widgets.sortAscending=Alfresco.util.createYUIButton(this,"sortAscending-button",this.onSortAscending);if(this.widgets.sortAscending!==null){this.widgets.sortAscending.set("title",this.msg(this.options.sortAscending?"button.sort.descending":"button.sort.ascending"));if(!this.options.sortAscending){z.addClass(this.widgets.sortAscending.get("element"),"sort-descending")}this.sortControls.push(this.widgets.sortAscending)}this.widgets.sortField=Alfresco.util.createYUIButton(this,"sortField-button",this.onSortField,{type:"menu",menu:"sortField-menu",lazyloadmenu:false});if(this.widgets.sortField!==null){this.sortControls.push(this.widgets.sortField);var a2=this.widgets.sortField.getMenu().getItems(),a9;for(a9 in a2){if(a2.hasOwnProperty(a9)){if(a2[a9].value===this.options.sortField){this.widgets.sortField.set("label",a2[a9].cfg.getProperty("text"));break}}}}this.widgets.showFolders=Alfresco.util.createYUIButton(this,"showFolders-button",this.onShowFolders,{type:"checkbox",checked:this.options.showFolders});if(this.widgets.showFolders!==null){this.widgets.showFolders.set("title",this.msg(this.options.showFolders?"button.folders.hide":"button.folders.show"));this.dynamicControls.push(this.widgets.showFolders)}if(z.get(this.id+"-simpleDetailed")){this.widgets.viewRendererSelect=new YAHOO.widget.ButtonGroup(this.id+"-simpleDetailed");if(this.widgets.viewRendererSelect!==null){this.widgets.viewRendererSelect.check(a4);this.widgets.viewRendererSelect.on("checkedButtonChange",this.onViewRendererSelect,this.widgets.viewRendererSelect,this);this.dynamicControls.push(this.widgets.viewRendererSelect)}}this.widgets.fileSelect=Alfresco.util.createYUIButton(this,"fileSelect-button",this.onFileSelect,{type:"menu",menu:"fileSelect-menu"});if(this.widgets.fileSelect!==null){this.dynamicControls.push(this.widgets.fileSelect)}if(z.get(this.id+"-options-button")){this.widgets.optionsMenu=Alfresco.util.createYUIButton(this,"options-button",this.onOptionSelect,{type:"menu",menu:"options-menu"});if(this.widgets.optionsMenu!==null){this.dynamicControls.push(this.widgets.optionsMenu)}}}this.services.preferences=new Alfresco.service.Preferences();this.services.likes=new Alfresco.service.Ratings(Alfresco.service.Ratings.LIKES);this._setupViewRenderers();this._setupDataSource();this._setupDataTable();var bg=function a3(bm,bl){var bi=YAHOO.Bubbling.getOwnerByTagName(bl[1].anchor,"div");if(bi!==null){if(typeof be[bi.id]==="function"){bl[1].stop=true;var bk=bl[1].target;if(typeof be.viewRenderers[be.options.viewRendererName]==="object"){bk=be.viewRenderers[be.options.viewRendererName].getDataTableRecordIdFromRowElement(be,bl[1].target)}var bj=be.widgets.dataTable.getRecord(bk).getData();be[bi.id].call(be,bj,bi)}}return true};YAHOO.Bubbling.addDefaultAction("action-link",bg);YAHOO.Bubbling.addDefaultAction("show-more",bg);var bc=function bf(bk,bj){var bi=YAHOO.Bubbling.getOwnerByTagName(bj[1].anchor,"div");if(bi!==null){be.onLikes.call(be,bj[1].target.offsetParent,bi)}return true};YAHOO.Bubbling.addDefaultAction("like-action",bc);var bb=function a1(bk,bj){var bi=YAHOO.Bubbling.getOwnerByTagName(bj[1].anchor,"div");if(bi!==null){be.onFavourite.call(be,bj[1].target.offsetParent,bi)}return true};YAHOO.Bubbling.addDefaultAction("favourite-action",bb);var bd=function a5(bk,bj){var bi=bj[1].anchor;if(bi!==null){var bl=bi.rel,bm,bn={};if(bl&&bl!==""){bj[1].stop=true;bm=bl.split("|");bn={filterOwner:window.unescape(bm[0]||""),filterId:window.unescape(bm[1]||""),filterData:window.unescape(bm[2]||""),filterDisplay:window.unescape(bm[3]||"")};Alfresco.logger.debug("DL_fnChangeFilterHandler","changeFilter =>",bn);YAHOO.Bubbling.fire("changeFilter",bn)}}return true};YAHOO.Bubbling.addDefaultAction("filter-change",bd);this.modules.actions=new Alfresco.module.DoclibActions();N.addListener(window,"resize",this._resizeRowContainers,this,true);YAHOO.util.History.onReady(this.onHistoryManagerReady,this,true);try{YAHOO.util.History.initialize("yui-history-field","yui-history-iframe")}catch(ba){Alfresco.logger.error(this.name+": Couldn't initialize HistoryManager.",ba);this.onHistoryManagerReady()}var a7=new Alfresco.widget.FullScreen(this.id);this.fullscreen=a7;YAHOO.util.Event.addListener(z.get(this.id+"-fullscreen-exit-button"),"click",function(bi){a7.toggleFullScreen()});YAHOO.Bubbling.on("fullScreenEnterComplete",function(bj,bi){if(bi[1]&&bi[1].eventGroup==this.id&&(typeof this.viewRenderers[this.options.viewRendererName]==="object")&&this.viewRenderers[this.options.viewRendererName].currentResizeCallback){this.viewRenderers[this.options.viewRendererName].currentResizeCallback()}},this);YAHOO.Bubbling.on("fullScreenExitComplete",function(bj,bi){if(bi[1]&&bi[1].eventGroup==this.id&&(typeof this.viewRenderers[this.options.viewRendererName]==="object")&&this.viewRenderers[this.options.viewRendererName].currentResizeCallback){this.viewRenderers[this.options.viewRendererName].currentResizeCallback()}},this);YAHOO.Bubbling.fire("postDocumentListOnReady",{scope:this,eventGroup:this.id})},_insituCallback:function am(a3,a2){var a7=a2.jsNode,a6=a7.nodeRef,a5="components/documentlibrary/data";if(E(this.options.siteId)){a5+="/site/"+encodeURIComponent(this.options.siteId)}Alfresco.util.Ajax.request({url:Alfresco.constants.URL_SERVICECONTEXT+a5+"/node/"+a6.uri+"?filter="+encodeURIComponent(this.currentFilter.filterId)+"&view="+this.actionsView+"&noCache="+new Date().getTime(),successCallback:{fn:function a1(a8){a8.json.item.jsNode=new Alfresco.util.Node(a8.json.item.node);YAHOO.Bubbling.fire(a7.isContainer?"folderRenamed":"fileRenamed",{file:a8.json.item});return false},scope:this},failureCallback:{fn:function a4(a8){},scope:this}})},fnRenderCellSelected:function az(){var a1=this;return function a2(a4,a3,a5,a6){if(typeof a1.viewRenderers[a1.options.viewRendererName]==="object"){a1.viewRenderers[a1.options.viewRendererName].renderCellSelected(a1,a4,a3,a5,a6)}}},fnRenderCellStatus:function P(){var a1=this;return function a2(a4,a3,a5,a6){if(typeof a1.viewRenderers[a1.options.viewRendererName]==="object"){a1.viewRenderers[a1.options.viewRendererName].renderCellStatus(a1,a4,a3,a5,a6)}}},fnRenderCellThumbnail:function aU(){var a1=this;return function a2(a4,a3,a5,a6){if(typeof a1.viewRenderers[a1.options.viewRendererName]==="object"){a1.viewRenderers[a1.options.viewRendererName].renderCellThumbnail(a1,a4,a3,a5,a6)}}},fnRenderCellDescription:function aR(){var a1=this;return function a2(a4,a3,a5,a6){if(typeof a1.viewRenderers[a1.options.viewRendererName]==="object"){a1.viewRenderers[a1.options.viewRendererName].renderCellDescription(a1,a4,a3,a5,a6)}}},fnRenderCellActions:function aV(){var a2=this;return function a1(a4,a3,a5,a6){if(typeof a2.viewRenderers[a2.options.viewRendererName]==="object"){a2.viewRenderers[a2.options.viewRendererName].renderCellActions(a2,a4,a3,a5,a6)}}},renderProperty:function(a1){if(YAHOO.lang.isString(a1)){return f(a1)}else{if(YAHOO.lang.isArray(a1)){return a1.length}else{if(YAHOO.lang.isBoolean(a1)){return a1}else{if(YAHOO.lang.isNumber(a1)){return a1}else{if(YAHOO.lang.isObject(a1)){if(a1.hasOwnProperty("iso8601")){return M(a1.iso8601)}else{if(a1.hasOwnProperty("userName")&&a1.hasOwnProperty("displayName")){return Alfresco.util.userProfileLink(a1.userName,a1.displayName)}else{if(a1.hasOwnProperty("displayName")){return f(a1.displayName||"")}else{if(a1.hasOwnProperty("title")){return f(a1.title||"")}else{if(a1.hasOwnProperty("name")){return f(a1.name||"")}}}}}}}}}}return""},onRegisterRenderer:function Q(a2,a1){var a3=a1[1];if(a3&&E(a3.propertyName)&&E(a3.renderer)){this.registerRenderer(a3.propertyName,a3.renderer)}else{Alfresco.logger.error("DL_onRegisterRenderer: Custom renderer registion invalid: "+a3)}},onRegisterViewRenderer:function m(a2,a1){var a3=a1[1];if(a3&&E(a3.renderer)){this.registerViewRenderer(a3.renderer)}else{Alfresco.logger.error("DL_onRegisterViewRenderer: Custom view renderer registion invalid: "+a3)}},registerRenderer:function aF(a1,a2){if(E(a1)&&E(a2)){this.renderers[a1]=a2;return true}return false},registerViewRenderer:function O(a1){if(E(a1)){this.viewRenderers[a1.name]=a1;this.viewRenderers[a1.name].setupRenderer(this);return true}return false},_setupMetadataRenderers:function A(){this.registerRenderer("i18nLabel",function(a1,a2){return a2.replace(/:\s$/,"")});this.registerRenderer("lockBanner",function(a1,a3){var a5=a1.jsNode.properties,a8=a5.lockOwner||a5.workingCopyOwner,a2=Alfresco.DocumentList.generateUserLink(this,a8),a7=a1.jsNode.isContainer,a6="details.banner.",a4="";if(a7){a6+="folder."}if(a1.workingCopy&&E(a1.workingCopy.googleDocUrl)){if(a8.userName===Alfresco.constants.USERNAME){a4=this.msg(a6+"google-docs-owner",'<a href="'+a1.workingCopy.googleDocUrl+'" target="_blank">'+this.msg("details.banner.google-docs.link")+"</a>")}else{a4=this.msg(a6+"google-docs-locked",a2,'<a href="'+a1.workingCopy.googleDocUrl+'" target="_blank">'+this.msg("details.banner.google-docs.link")+"</a>")}}else{if(a1.workingCopy&&a8.userName===Alfresco.constants.USERNAME){a4=this.msg(a6+(a1.workingCopy.isWorkingCopy?"editing":"lock-owner"))}else{if(a8.userName===Alfresco.constants.USERNAME){a4=this.msg(a6+"lock-owner")}else{a4=this.msg(a6+"locked",a2)}}}return a4});this.registerRenderer("syncFailed",function(a1,a2){return'<span class="banner-more-info-link">'+this.msg("details.banner.more-info")+"</span>"+this.msg("details.banner.sync-failed")});this.registerRenderer("syncTransientError",function(a1,a2){return'<span class="banner-more-info-link">'+this.msg("details.banner.more-info")+"</span>"+this.msg("details.banner.sync-transient-error")});this.registerRenderer("date",function(a1,a2){var a6=a1.jsNode,a4=a6.properties,a3="";var a5="modified",a7=a4.modified.iso8601;if(a1.workingCopy&&a1.workingCopy.isWorkingCopy){a5="editing-started"}else{if(a7===a4.created.iso8601){a5="created"}}a3='<span class="item">'+a2+this.msg("details."+a5+"-by",aa(a7),Alfresco.DocumentList.generateUserLink(this,a4.modifier))+"</span>";return a3});this.registerRenderer("size",function(a1,a2){var a5=a1.jsNode,a4=a5.properties,a3="";if(!a5.isContainer&&!a5.isLink){a3+='<span class="item">'+a2+Alfresco.util.formatFileSize(a5.size)+"</span>"}return a3});this.registerRenderer("name",function(a1,a2){var a5=a1.jsNode,a4=a5.properties,a3="";if(a5.hasPermission("Write")&&!a5.isLocked&&!a5.hasAspect("cm:workingcopy")){this.insituEditors.push({context:"___"+a1._filenameId,params:{type:"textBox",nodeRef:a5.nodeRef.toString(),name:"prop_cm_name",value:a1.fileName,fnSelect:function a6(a8,a9){var a7=a9.lastIndexOf(Alfresco.util.getFileExtension(a9))-1;if(a7>0){Alfresco.util.selectText(a8,0,a7)}else{a8.select()}},validations:[{type:Alfresco.forms.validation.length,args:{min:1,max:255,crop:true},when:"keyup",message:this.msg("validation-hint.length.min.max",1,255)},{type:Alfresco.forms.validation.nodeName,when:"keyup",message:this.msg("validation-hint.nodeName")}],title:this.msg("tip.insitu-rename"),errorMessage:this.msg("message.insitu-edit.name.failure")},callback:{fn:this._insituCallback,scope:this,obj:a1}})}a3+='<span id="___'+a1._filenameId+'">'+Alfresco.DocumentList.generateFileFolderLinkMarkup(this,a1);a3+=f(a1.displayName)+"</a></span>";return a3});this.registerRenderer("version",function(a1,a2){var a5=a1.jsNode,a4=a5.properties,a3="";if(!a5.isContainer&&!a5.isLink){a3+='<span class="item">'+a2+a1.version+"</span>"}return a3});this.registerRenderer("description",function(a1,a2){var a5=a1.jsNode,a4=a5.properties,a6=Alfresco.util.generateDomId(),a3='<span id="'+a6+'" class="faded">'+a2+this.msg("details.description.none")+"</span>";if(a4.description&&a4.description!==""){a3='<span id="'+a6+'" class="item">'+a2+aj(f(a4.description))+"</span>"}return a3});this.registerRenderer("tags",function(a6,a8){var a2=a6.jsNode,a7=a2.properties,a1=Alfresco.util.generateDomId(),a5="";var a9=a2.tags,ba;if(a2.hasAspect("cm:taggable")&&a9.length>0){for(var a4=0,a3=a9.length;a4<a3;a4++){ba=f(a9[a4]);a5+='<span class="tag"><a href="#" class="tag-link" rel="'+ba+'">'+ba+"</a></span>"}}else{a5+='<span class="faded">'+a8+this.msg("details.tags.none")+"</span>"}if(a2.hasPermission("Write")&&!a2.isLocked){this.insituEditors.push({context:a1,params:{type:"tagEditor",nodeRef:a2.nodeRef.toString(),name:"prop_cm_taggable",value:a6.node.properties["cm:taggable"],validations:[{type:Alfresco.forms.validation.nodeName,when:"keyup",message:this.msg("validation-hint.nodeName")},{type:Alfresco.forms.validation.length,args:{min:1,max:255,crop:true,ignoreEmpty:true},when:"keyup",message:this.msg("validation-hint.length.min.max",1,255)}],title:this.msg("tip.insitu-tag"),errorMessage:this.msg("message.insitu-edit.tag.failure")},callback:{fn:this._insituCallback,scope:this,obj:a6}})}return'<span id="'+a1+'" class="item">'+a8+a5+"</span>"});this.registerRenderer("categories",function(a7,a9){var a1=a7.jsNode,a8=a1.properties,a5="";if(a1.hasAspect("cm:generalclassifiable")){var a6=a1.categories,a2;a5+='<span class="category-item item">&nbsp;</span><span class="item">'+a9;if(a6.length>0){for(var a4=0,a3=a6.length;a4<a3;a4++){a2=a6[a4];a5+='<span class="category"><a href="#" class="filter-change" rel="'+Alfresco.DocumentList.generateCategoryMarkup(a2)+'">'+f(a2[0])+"</a></span>"+(a3-a4>1?", ":"")}}else{a5+='<span class="faded">'+a9+this.msg("details.categories.none")+"</span>"}a5+="</span>"}return a5});this.registerRenderer("social",function(a1){var a3=a1.jsNode,a2="";a2+='<span class="item item-social">'+Alfresco.DocumentList.generateFavourite(this,a1)+"</span>";a2+='<span class="item item-social item-separator">'+Alfresco.DocumentList.generateLikes(this,a1)+"</span>";if(a3.permissions.user.CreateChildren){a2+='<span class="item item-social item-separator">'+Alfresco.DocumentList.generateComments(this,a1)+"</span>"}if(!a1.node.isContainer&&Alfresco.constants.QUICKSHARE_URL){a2+='<span class="item item-separator">'+Alfresco.DocumentList.generateQuickShare(this,a1)+"</span>"}return a2})},_setupViewRenderers:function T(){for(var a3=0;a3<this.options.viewRenderers.length;a3++){var a4=this.options.viewRenderers[a3].widget;if(a4!=null){var a2=a4.split(".");var a5=window;for(var a1=0;a1<a2.length;a1++){a5=a5[a2[a1]]}if(typeof a5==="function"){this.registerViewRenderer(new a5(this.options.viewRenderers[a3].id,this,this.options.viewRenderers[a3].jsonConfig))}}}YAHOO.Bubbling.fire("postSetupViewRenderers",{scope:this,eventGroup:this.id})},_setupHistoryManagers:function av(){var a4=YAHOO.util.History.getBookmarkedState("filter");a4=a4||"path|/";try{while(a4!==(a4=decodeURIComponent(a4.replace(/%25/g,"%2525")))){}}catch(a7){}var a2=function a9(ba){var bb=ba.split("|"),bc={filterId:window.unescape(bb[0]||"")};if(typeof bb[1]!=="undefined"){bc.filterData=window.unescape(bb[1])}if(typeof bb[2]!=="undefined"){bc.filterDisplay=window.unescape(bb[2])}bc.filterOwner=Alfresco.util.FilterManager.getOwner(bc.filterId);return bc};this.options.initialFilter=a2(a4);YAHOO.util.History.register("filter",a4,function a1(ba){Alfresco.logger.debug("HistoryManager: filter changed:"+ba);this._updateDocList.call(this,{filter:a2(ba),page:this.currentPage})},null,this);var a3=function a5(bb,ba){ba.widgets.paginator.setState(bb);YAHOO.util.History.navigate("page",String(bb.page))};if(this.options.usePagination){var a8=YAHOO.util.History.getBookmarkedState("page")||"1";while(a8!==(a8=decodeURIComponent(a8))){}this.currentPage=parseInt(a8||this.options.initialPage,10);YAHOO.util.History.register("page",a8,function a6(ba){Alfresco.logger.debug("HistoryManager: page changed:"+ba);if(this.currentPage!=ba){this._updateDocList.call(this,{page:ba})}else{Alfresco.logger.debug("...page changed event ignored.")}},null,this);this.widgets.paginator=new YAHOO.widget.Paginator({containers:[this.id+"-paginator",this.id+"-paginatorBottom"],rowsPerPage:this.options.pageSize,initialPage:this.currentPage,template:this.msg("pagination.template"),pageReportTemplate:this.msg("pagination.template.page-report"),previousPageLinkLabel:this.msg("pagination.previousPageLinkLabel"),nextPageLinkLabel:this.msg("pagination.nextPageLinkLabel")});this.widgets.paginator.subscribe("changeRequest",a3,this);z.setStyle(this.id+"-doclistBarBottom","display","block")}},_setupDataSource:function ab(){var a2=this;this.widgets.dataSource=new YAHOO.util.DataSource(this.dataSourceUrl,{responseType:YAHOO.util.DataSource.TYPE_JSON,responseSchema:{resultsList:"items",metaFields:{paginationRecordOffset:"startIndex",totalRecords:"totalRecords",totalRecordsUpper:"totalRecordsUpper"}}});this.widgets.dataSource.doBeforeCallback=function a1(a5,a3,a6){a2.doclistMetadata=a3.metadata;YAHOO.Bubbling.fire("doclistMetadata",{metadata:a2.doclistMetadata});var a4=null;if(a2.doclistMetadata.parent){a4=a2.doclistMetadata.parent.permissions;if(a4&&a4.user){YAHOO.Bubbling.fire("userAccess",{userAccess:a4.user})}}if(typeof a2.viewRenderers[a2.options.viewRendererName]==="object"){a2.viewRenderers[a2.options.viewRendererName].renderEmptyDataSourceHtml(a2,a4)}return a6}},_setupDataTable:function aS(){var ba=this;var a2=z.get("alf-filters"),a3=(a2?parseInt(a2.style.width,10):160)+390;var a4=[{key:"nodeRef",label:"Select",sortable:false,formatter:this.fnRenderCellSelected(),width:16},{key:"status",label:"Status",sortable:false,formatter:this.fnRenderCellStatus(),width:16},{key:"thumbnail",label:"Preview",sortable:false,formatter:this.fnRenderCellThumbnail(),width:100},{key:"fileName",label:"Description",sortable:false,formatter:this.fnRenderCellDescription(),width:(z.getViewportWidth()-a3)},{key:"actions",label:"Actions",sortable:false,formatter:this.fnRenderCellActions(),width:200}];this.widgets.dataTable=new YAHOO.widget.DataTable(this.id+"-documents",a4,this.widgets.dataSource,{renderLoopSize:this.options.usePagination?16:Alfresco.util.RENDERLOOPSIZE,initialLoad:false,dynamicData:true,MSG_EMPTY:this.msg("message.loading")});var a9=z.getElementsByClassName("yui-dt-empty");if(a9.length>0){a9[0].colSpan=100}this.widgets.dataTable.handleDataReturnPayload=function a6(bc,bb,bd){ba.totalRecords=bb.meta.totalRecords;ba.totalRecordsUpper=bb.meta.totalRecordsUpper;return bb.meta};this._setDefaultDataTableErrors(this.widgets.dataTable);this.widgets.dataTable.subscribe("tableMsgShowEvent",function(bg){this._elMsgTbody.parentNode.style.width="";if(bg.html&&bg.html.indexOf("docListInstructions")!==-1){var bj=Alfresco.util.ComponentManager.findFirst("Alfresco.DocListToolbar");if(bj!==null){var bh=z.get(ba.id+"-standard-upload-link-template-instance");if(bh!==null){var bk=z.getChildren(bh);N.addListener(bk[0],"click",bj.onFileUpload,bj,true);N.addListener(z.getFirstChild(bk[1]),"click",bj.onFileUpload,bj,true)}var bf=z.get(ba.id+"-new-folder-link-template-instance");if(bf!==null){var bi=z.getChildren(bf);N.addListener(bi[0],"click",bj.onNewFolder,bj,true);N.addListener(z.getFirstChild(bi[1]),"click",bj.onNewFolder,bj,true)}}var bb=z.get(ba.id+"-show-folders-template-instance");if(bb!==null){var bd=function bc(){this.widgets.showFolders.set("checked",true)};var be=z.getChildren(bb);N.addListener(be[0],"click",bd,ba,true);N.addListener(be[1],"click",bd,ba,true)}}});this.widgets.dataTable.sortColumn=function(bg,be){var bb=this.getColumnSortDir(bg);var bh=this.get("sortedBy")||{};var bc=(bh.key===bg.key)?true:false;var bd=this.getState();bd.sortedBy={key:bg.key,dir:bb};this.set("sortedBy",bd.sortedBy);var bf="ascending";if(bb!="yui-dt-asc"){bf="descending"}ba.onSortFieldEvent(bg.field,bf)};this.widgets.dataTable.doBeforeLoadData=function a1(bd,bf,bh){if(bf.error){try{var bb=YAHOO.lang.JSON.parse(bf.responseText);ba.widgets.dataTable.set("MSG_ERROR",bb.message)}catch(bg){ba._setDefaultDataTableErrors(ba.widgets.dataTable)}}else{if(bf.results.length===0){z.setStyle(ba.widgets.dataTable._elThead,"display","none");this.fireEvent("renderEvent",{type:"renderEvent"})}else{for(var bc=0,be=bf.results.length;bc<be;bc++){bf.results[bc].jsNode=new Alfresco.util.Node(bf.results[bc].node)}}}return true};this.widgets.dataTable.subscribe("checkboxClickEvent",function a7(bb){var bc=bb.target.value;this.selectedFiles[bc]=bb.target.checked;YAHOO.Bubbling.fire("selectedFilesChanged")},this,true);this.widgets.dataTable.subscribe("renderEvent",function a8(){Alfresco.logger.debug("DataTable renderEvent");if(0<YAHOO.env.ua.ie&&YAHOO.env.ua.ie<7){var bc=this.widgets.dataTable.getTableEl().parentNode;bc.className=bc.className}if(this.widgets.paginator){Alfresco.logger.debug("Setting paginator state: page="+this.currentPage+", totalRecords="+this.totalRecords);this.widgets.paginator.setState({page:this.currentPage,totalRecords:this.totalRecords});if(this.totalRecordsUpper){this.widgets.paginator.set("pageReportTemplate",this.msg("pagination.template.page-report.more"))}else{this.widgets.paginator.set("pageReportTemplate",this.msg("pagination.template.page-report"))}this.widgets.paginator.render()}if(this.options.highlightFile){YAHOO.Bubbling.fire("highlightFile",{fileName:window.unescape(this.options.highlightFile)})}else{if(this.listUpdated){var bg=z.getY(this.id+"-documents"),bb=YAHOO.env.ua.ie>0?((document.compatMode&&document.compatMode!=="BackCompat")?document.documentElement:document.body).scrollTop:window.scrollY;if(bb>bg){window.scrollTo(0,bg)}}}var bf,be;for(bf=0,be=this.afterDocListUpdate.length;bf<be;bf++){this.afterDocListUpdate[bf].call(this)}this.afterDocListUpdate=[];if(typeof this.widgets.previewTooltip!=="undefined"){this.widgets.previewTooltip.cfg.setProperty("context",this.previewTooltips)}var bd;for(bf=0,be=this.insituEditors.length;bf<be;bf++){bd=this.insituEditors[bf];Alfresco.util.createInsituEditor(bd.context,bd.params,bd.callback)}this.widgets.dataTable.set("renderLoopSize",this.options.usePagination?16:Alfresco.util.RENDERLOOPSIZE)},this,true);this.widgets.dataTable.subscribe("rowMouseoverEvent",this.onEventHighlightRow,this,true);this.widgets.dataTable.subscribe("rowMouseoutEvent",this.onEventUnhighlightRow,this,true);N.delegate(this.id,"click",function a5(bc,be){var bd=be.getAttribute("data-action"),bb=ba.widgets.dataTable.getRecord(be).getData();if(YAHOO.lang.isFunction(ba[bd])){ba[bd].call(ba,bb,be)}else{if(YAHOO.lang.isFunction(window[bd])){window[bd](bb,be)}}},"a.indicator-action");if(this.dragAndDropEnabled){N.addListener(document.body,"dragenter",this._swallowDragEnter,this,true);N.addListener(document.body,"dragover",this._swallowDragOver,this,true);N.addListener(document.body,"drop",this._swallowDragDrop,this,true);N.addListener(document.body,"dragstart",this._swallowDragStart,this,true)}},_removeDragAndDrop:function ar(){if(this.dragAndDropEnabled){try{var a2=z.get(this.id+"-dl-body");N.removeListener(a2,"dragenter");N.removeListener(a2,"dragover");N.removeListener(a2,"dragleave");N.removeListener(a2,"drop")}catch(a1){Alfresco.logger.error("_removeDragAndDrop: The following exception occurred: ",a1)}}},_addDragAndDrop:function G(){if(this._userCanUpload&&this.dragAndDropEnabled){try{var a2=z.get(this.id+"-dl-body");N.addListener(a2,"dragenter",this.onDocumentListDragEnter,this,true);N.addListener(a2,"dragover",this.onDocumentListDragOver,this,true);N.addListener(a2,"dragleave",this.onDocumentListDragLeave,this,true);N.addListener(a2,"drop",this.onDocumentListDrop,this,true)}catch(a1){Alfresco.logger.error("_addDragAndDrop: The following exception occurred: ",a1)}}},_swallowDragStart:function r(a1){a1.stopPropagation();a1.preventDefault()},_swallowDragEnter:function s(a1){a1.stopPropagation();a1.preventDefault()},_swallowDragOver:function ad(a1){a1.dataTransfer.dropEffect="none";a1.stopPropagation();a1.preventDefault()},_swallowDrop:function ax(a1){a1.stopPropagation();a1.preventDefault()},onDocumentListDragEnter:function an(a6){var a2=a6.target,a4=this.widgets.dataTable.getRecord(a2),a1=this.widgets.dataTable.getColumn(a2),a5=this.widgets.dataTable.getContainerEl(),a3;if(a4&&a1&&(a2.tagName=="IMG"||a2.className=="droppable")&&a1.getKey()=="thumbnail"){a3=a4.getData("jsNode");if(a3&&a3.isContainer){this.dragFolderHighlight=z.getAncestorByClassName(a2,"folder");z.addClass(this.dragFolderHighlight,"dndFolderHighlight");z.removeClass(a5,"dndDocListHighlight")}}else{this.dragEventRefCount=Math.min(++this.dragEventRefCount,2);z.addClass(a5,"dndDocListHighlight");if(this.dragFolderHighlight){z.removeClass(this.dragFolderHighlight,"dndFolderHighlight");this.dragFolderHighlight=null}}a6.stopPropagation();a6.preventDefault()},onDocumentListDragOver:function k(a1){a1.dataTransfer.dropEffect=Math.floor(YAHOO.env.ua.gecko)===1?"move":"copy";a1.stopPropagation();a1.preventDefault()},onDocumentListDragLeave:function aX(a5){var a2=a5.target,a3=this.widgets.dataTable.getRecord(a2),a4=this.widgets.dataTable.getColumn(a2),a1=a3?a3.getData():null;if(a3&&a4&&(a2.tagName=="IMG"||a2.className=="droppable")&&a1.node.isContainer&&a4.getKey()=="thumbnail"){}else{if(--this.dragEventRefCount===0){z.removeClass(this.widgets.dataTable.getContainerEl(),"dndDocListHighlight")}}a5.stopPropagation();a5.preventDefault()},onDocumentListDrop:function af(bb){try{if(bb.dataTransfer.files!==undefined&&bb.dataTransfer.files!==null&&bb.dataTransfer.files.length>0){var a8=Alfresco.getDNDUploadProgressInstance();var a2=false;var bc="",a5,a4;a4=bb.dataTransfer.files.length;for(a5=0;a5<a4;a5++){if(bb.dataTransfer.files[a5].size>0){a2=true}else{bc+='"'+bb.dataTransfer.files[a5].fileName+'", '}}if(!a2){bc=bc.substring(0,bc.lastIndexOf(", "));Alfresco.util.PopupManager.displayMessage({text:a8.msg("message.zeroByteFiles",bc)})}if(a2&&a8.uploadMethod===a8.INMEMORY_UPLOAD){var bf=0;a4=bb.dataTransfer.files.length;for(a5=0;a5<a4;a5++){bf+=bb.dataTransfer.files[a5].size}if(bf>a8.getInMemoryLimit()){a2=false;Alfresco.util.PopupManager.displayPrompt({text:a8.msg("inmemory.uploadsize.exceeded",Alfresco.util.formatFileSize(a8.getInMemoryLimit()))})}}if(a2){var ba=this.currentPath,a1=ba.substring(ba.lastIndexOf("/")+1),bd=this.doclistMetadata.parent?this.doclistMetadata.parent.nodeRef:null;var bg=this.widgets.dataTable.getRecord(bb.target);if(bg!==null){var a9=this.widgets.dataTable.getColumn(bb.target),a7=bg.getData();if(bg&&a9&&bb.target.tagName=="IMG"&&a7.node.isContainer&&a9.getKey()=="thumbnail"){var be=a7.location;a1=be.file;ba=aH(be.path,be.file);bd=a7.nodeRef}}z.removeClass(this.widgets.dataTable.getTrEl(bb.target),"dndFolderHighlight");z.removeClass(this.widgets.dataTable.getContainerEl(),"dndDocListHighlight");var a6={files:bb.dataTransfer.files,uploadDirectoryName:a1,filter:[],mode:a8.MODE_MULTI_UPLOAD,thumbnails:"doclib",onFileUploadComplete:{fn:this.onFileUploadComplete,scope:this}};if(E(this.options.siteId)){a6.siteId=this.options.siteId;a6.containerId=this.options.containerId;a6.uploadDirectory=ba}else{a6.destination=bd}a8.show(a6)}}else{Alfresco.logger.debug("DL_onDocumentListDrop: A drop event was detected, but no files were present for upload: ",bb.dataTransfer)}}catch(a3){Alfresco.logger.error("DL_onDocumentListDrop: The following error occurred when files were dropped onto the Document List: ",a3)}bb.stopPropagation();bb.preventDefault()},onHistoryManagerReady:function x(){if(this.options.initialFilter.filterId==="path"&&window.location.hash=="#upload"){window.location.hash="";var a1=function a2(){YAHOO.Bubbling.fire("showFileUploadDialog",{tooltip:this.msg("dnd.upload.tooltip")})};this.afterDocListUpdate.push(a1)}Alfresco.logger.debug("DL_onHistoryManagerReady","changeFilter =>",this.options.initialFilter);YAHOO.Bubbling.fire("changeFilter",YAHOO.lang.merge({doclistFirstTimeNav:true},this.options.initialFilter));z.setStyle(this.id+"-dl-body","visibility","visible")},getSelectedFiles:function a0(){var a5=[],a6=this.widgets.dataTable.getRecordSet(),a4,a3,a2,a1;for(a2=0,a1=a6.getLength();a2<a1;a2++){a4=a6.getRecord(a2);a3=a4.getData("node");if(this.selectedFiles[a3.nodeRef]){a5.push(a4.getData())}}return a5},selectFiles:function y(bc){var bd;if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){bd=z.get(this.id+this.viewRenderers[this.options.viewRendererName].parentElementIdSuffix)}var a8=this.widgets.dataTable.getRecordSet(),a3=YAHOO.util.Selector.query('input[type="checkbox"]',bd),a7=a3.length,be,a5,a4,bb;switch(bc){case"selectAll":bb=function a9(bf,bg){return true};break;case"selectNone":bb=function a6(bf,bg){return false};break;case"selectInvert":bb=function a2(bf,bg){return !bg};break;case"selectDocuments":bb=function a1(bf,bg){return !(bf.node.isContainer)};break;case"selectFolders":bb=function a1(bf,bg){return bf.node.isContainer};break;default:bb=function ba(bf,bg){return bg}}for(a4=0;a4<a7;a4++){be=a8.getRecord(a4);a5=be.getData();this.selectedFiles[a5.nodeRef]=a3[a4].checked=bb(a5,a3[a4].checked)}YAHOO.Bubbling.fire("selectedFilesChanged")},onSortAscending:function W(a1,a2){this.widgets.dataTable.set("sortedBy",null);this.options.sortAscending=!this.options.sortAscending;this.widgets.sortAscending.set("title",this.msg(this.options.sortAscending?"button.sort.descending":"button.sort.ascending"));if(this.options.sortAscending){z.removeClass(this.widgets.sortAscending.get("element"),"sort-descending")}else{z.addClass(this.widgets.sortAscending.get("element"),"sort-descending")}this.services.preferences.set(aD,this.options.sortAscending);YAHOO.Bubbling.fire("metadataRefresh");if(a1){N.preventDefault(a1)}},onSortEvent:function aZ(a1){this.options.sortAscending=(a1!="descending");this.services.preferences.set(aD,this.options.sortAscending);YAHOO.Bubbling.fire("metadataRefresh")},onSortField:function aP(a6,a5,a4){this.widgets.dataTable.set("sortedBy",null);var a1=a5[0],a3=a5[1];if(a3){var a2=this;this.options.sortField=a3.value;this.widgets.sortField.set("label",a3.cfg.getProperty("text"));this.services.preferences.set(d,this.options.sortField,{successCallback:{fn:function(){var a7=a3.srcElement.getAttribute("title");if(a7==="true"||a7==="false"){a2.options.sortAscending=(a7==="false");a2.onSortAscending()}else{YAHOO.Bubbling.fire("metadataRefresh")}}}})}N.preventDefault(a1)},onSortFieldEvent:function J(a3,a2){this.options.sortField=a3;var a1=this;this.services.preferences.set(d,a3,{successCallback:{fn:function(){if(a2){a1.options.sortAscending=(a2==="ascending");a1.onSortEvent(a2)}else{YAHOO.Bubbling.fire("metadataRefresh")}}}})},onShowFolders:function i(a1,a2){this.options.showFolders=this.widgets.showFolders.get("checked");this.widgets.showFolders.set("title",this.msg(this.options.showFolders?"button.folders.hide":"button.folders.show"));this.services.preferences.set(X,this.options.showFolders);YAHOO.Bubbling.fire("metadataRefresh");if(a1){N.preventDefault(a1)}},onShowFoldersEvent:function o(a1){this.options.showFolders=a1;this.services.preferences.set(X,this.options.showFolders);YAHOO.Bubbling.fire("metadataRefresh")},onViewRendererSelect:function aY(a1,a2){this.widgets.dataTable.set("sortedBy",null);this.options.viewRendererName=this.options.viewRendererNames[a1.newValue.index];this.userPreferredView=this.options.viewRendererName;this.services.preferences.set(Y,this.options.viewRendererName);YAHOO.Bubbling.fire("metadataRefresh");if(a1){N.preventDefault(a1)}},onViewRendererSelectEvent:function aB(a1){var a4=false;for(var a3=0;a3<this.options.viewRendererNames.length&&!a4;a3++){a4=(this.options.viewRendererNames[a3]==a1)}if(a4){this.widgets.dataTable.set("sortedBy",null);this.options.viewRendererName=a1;this.userPreferredView=this.options.viewRendererName;this.services.preferences.set(Y,this.options.viewRendererName);for(var a3=0;a3<this.options.viewRenderers.length;a3++){if(this.options.viewRenderers[a3].id==this.options.viewRendererName){var a2=z.getElementsByClassName("setDefaultView");a2[0].innerHTML=this.msg("button.setDefaultView",this.options.viewRenderers[a3].label);break}}YAHOO.Bubbling.fire("metadataRefresh")}},onFileSelect:function c(a5,a4,a3){var a1=a4[0],a2=a4[1];this.selectFiles(Alfresco.util.findEventClass(a2));N.preventDefault(a1)},onOptionSelect:function aC(a2,a8,be){var a9=a8[0],bd=a8[1];var a4=Alfresco.util.findEventClass(bd);var a3=bd.element;while((a3!==null)&&((a3.tagName.toLowerCase()!="span")||(a3.className.indexOf("yui")===0))){a3=a3.firstChild}var ba=a3;if(a4=="showFolders"){this.options.showFolders=true;ba.innerHTML=this.msg("button.folders.hide");z.replaceClass(ba,"showFolders","hideFolders");this.services.preferences.set(X,this.options.showFolders);YAHOO.Bubbling.fire("metadataRefresh")}else{if(a4=="hideFolders"){this.options.showFolders=false;ba.innerHTML=this.msg("button.folders.show");z.replaceClass(ba,"hideFolders","showFolders");this.services.preferences.set(X,this.options.showFolders);YAHOO.Bubbling.fire("metadataRefresh")}else{if(a4=="showPath"){this.options.hideNavBar=false;ba.innerHTML=this.msg("button.navbar.hide");z.replaceClass(ba,"showPath","hidePath");this.services.preferences.set(D,this.options.hideNavBar);z.setStyle(this.options.associatedToolbar.id+"-navBar","display",this.options.hideNavBar?"none":"block")}else{if(a4=="hidePath"){this.options.hideNavBar=true;ba.innerHTML=this.msg("button.navbar.show");z.replaceClass(ba,"hidePath","showPath");this.services.preferences.set(D,this.options.hideNavBar);z.setStyle(this.options.associatedToolbar.id+"-navBar","display",this.options.hideNavBar?"none":"block")}else{if(a4=="fullWindow"){this.fullscreen.toggleFullScreen(true)}else{if(a4=="fullScreen"){this.fullscreen.toggleFullScreen(false)}else{if(a4=="rss"){window.location=this.options.associatedToolbar._getRssFeedUrl()}else{if(a4=="removeDefaultView"||a4=="setDefaultView"){if(a4=="setDefaultView"){for(var a6=0;a6<this.options.viewRenderers.length;a6++){if(this.options.viewRenderers[a6].id==this.options.viewRendererName){var bb=z.getElementsByClassName("removeDefaultView");bb[0].innerHTML=this.msg("button.removeDefaultView",this.options.viewRenderers[a6].label);break}}}var bc=this.doclistMetadata.parent.nodeRef;bc=bc.replace(/:\//g,"");var a7=this;var a1={prop_app_defaultViewId:(a4=="removeDefaultView"?"":this.options.viewRendererName)};Alfresco.util.Ajax.jsonRequest({method:"POST",url:Alfresco.constants.PROXY_URI+"api/node/"+bc+"/formprocessor",dataObj:a1,successCallback:{fn:function(){this._updateDocList.call(this)},scope:this},failure:{message:a7.msg("message.save.failure")}})}else{if(a4.indexOf=="view "!=-1){var a5=a4.substring(5);this.onViewRendererSelectEvent(a5)}}}}}}}}}N.preventDefault(a9)},onEventHighlightRow:function Z(a1){if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){this.viewRenderers[this.options.viewRendererName].onEventHighlightRow(this,a1)}},onEventUnhighlightRow:function I(a1){if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){this.viewRenderers[this.options.viewRendererName].onEventUnhighlightRow(this,a1)}},onActionShowMore:function C(a2,a1){if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){this.viewRenderers[this.options.viewRendererName].onActionShowMore(this,a2,a1)}},onActionEditOffline:function S(a3){if(!this.state.actionEditOfflineActive){this.state.actionEditOfflineActive=true;var a4=a3.jsNode.nodeRef,a2=a3.displayName;this.modules.actions.genericAction({success:{event:{name:"metadataRefresh"},callback:{fn:function a5(a8){this.state.actionEditOfflineActive=false;this.options.highlightFile=a2;var a7=function a6(){var a9=false;YAHOO.Bubbling.on("editingCanceled",function(be,bd){if(a8.config.object.nodeRef==bd[1].record.workingCopy.sourceNodeRef.replace(/:\//g,"")){a9=true}},this);var bc=Alfresco.constants.PROXY_URI+a8.json.results[0].downloadUrl;if(YAHOO.env.ua.ie>6){Alfresco.util.PopupManager.displayPrompt({title:this.msg("message.edit-offline.success",a2),text:this.msg("message.edit-offline.success.ie7"),buttons:[{text:this.msg("button.download"),handler:function bb(){window.location=bc;this.destroy()},isDefault:true},{text:this.msg("button.close"),handler:function ba(){this.destroy()}}]})}else{Alfresco.util.PopupManager.displayMessage({text:this.msg("message.edit-offline.success",a2)});YAHOO.lang.later(3000,this,function(){if(!a9){window.location=bc}})}};this.afterDocListUpdate.push(a7)},scope:this}},failure:{callback:{fn:function a1(){this.state.actionEditOfflineActive=false},scope:this},message:this.msg("message.edit-offline.failure",a2)},webscript:{method:Alfresco.util.Ajax.POST,name:"checkout/node/{nodeRef}",params:{nodeRef:a4.uri}}})}},onActionCheckoutToGoogleDocs:function aO(a3){var a2=a3.displayName,a5=a3.jsNode.nodeRef,a6=a3.location.path,a8=a3.fileName;var a7=Alfresco.util.PopupManager.displayMessage({displayTime:0,effect:null,text:this.msg("message.checkout-google.inprogress",a2)});this.modules.actions.genericAction({success:{event:{name:"changeFilter",obj:{filterId:"editingMe"}},callback:{fn:function a1(bb){a7.destroy();this.options.highlightFile=a2;var a9=function ba(){Alfresco.util.PopupManager.displayMessage({text:this.msg("message.checkout-google.success",a2)})};this.afterDocListUpdate.push(a9)},scope:this},activity:{siteId:this.options.siteId,activityType:"google-docs-checkout",page:"document-details",activityData:{fileName:a8,path:a6,nodeRef:a5.toString()}}},failure:{callback:{fn:function a4(a9){a7.destroy();Alfresco.util.PopupManager.displayMessage({text:this.msg("message.checkout-google.failure",a2)})},scope:this}},webscript:{method:Alfresco.util.Ajax.POST,name:"checkout/node/{nodeRef}?gdc=1",params:{nodeRef:a5.uri}}})},onActionCheckinFromGoogleDocs:function l(a3){var a2=a3.displayName,a4=a3.jsNode.nodeRef,a1=new Alfresco.util.NodeRef(a3.workingCopy.sourceNodeRef),a5=a3.location.path;var a7=Alfresco.util.PopupManager.displayMessage({displayTime:0,effect:null,text:this.msg("message.checkin-google.inprogress",a2)});this.modules.actions.genericAction({success:{event:{name:"metadataRefresh"},callback:{fn:function a6(ba){a7.destroy();var a8=function a9(){Alfresco.util.PopupManager.displayMessage({text:this.msg("message.checkin-google.success",a2)})};this.afterDocListUpdate.push(a8)},scope:this},activity:{siteId:this.options.siteId,activityType:"google-docs-checkin",page:"document-details",activityData:{fileName:a2,path:a5,nodeRef:a1.toString()}}},failure:{message:this.msg("message.checkin-google.failure",a2)},webscript:{method:Alfresco.util.Ajax.POST,name:"checkin/node/{nodeRef}",params:{nodeRef:a4.uri}}})},onFileAction:function aA(a2,a1){var a3=a1[1];if(a3){if(!a3.multiple){this._updateDocList.call(this)}}},onFileRenamed:function K(a2,a1){if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){this.viewRenderers[this.options.viewRendererName].onFileRenamed(this,a2,a1)}},onDocListRefresh:function ae(a2,a1){var a3=a1[1];if(a3&&(a3.highlightFile!==null)){this.options.highlightFile=a3.highlightFile}this._updateDocList.call(this)},onChangeFilter:function H(a3,a2){var a6=a2[1];if((a6!==null)&&(a6.filterId!==null)){var a5=Alfresco.util.cleanBubblingObject(a6),a4=window.escape(a6.filterId)+(typeof a6.filterData!=="undefined"?"|"+window.escape(a6.filterData)+(typeof a6.filterDisplay!=="undefined"?"|"+window.escape(a6.filterDisplay):""):"");Alfresco.logger.debug("DL_onChangeFilter: ",a5);this._removeDragAndDrop();if(a6.filterId==="path"){this._addDragAndDrop()}this.listUpdated=true;var a1={filter:a4};if(a6.doclistFirstTimeNav||this.currentFilter.filterData==a5.filterData){this._updateDocList.call(this,{filter:a5,page:this.currentPage})}else{if(this.options.usePagination){this.currentPage=1;a1.page="1"}Alfresco.logger.debug("DL_onChangeFilter: objNav = ",a1);if(this.options.highlightFile&&a1.filter===YAHOO.util.History.getCurrentState("filter")){YAHOO.Bubbling.fire("highlightFile",{fileName:this.options.highlightFile})}YAHOO.util.History.multiNavigate(a1)}}},onFilterChanged:function v(a2,a1){var a3=a1[1];if((a3!==null)&&(a3.filterId!==null)){a3.filterOwner=a3.filterOwner||Alfresco.util.FilterManager.getOwner(a3.filterId);this.currentFilter=Alfresco.util.cleanBubblingObject(a3);Alfresco.logger.debug("DL_onFilterChanged: ",this.currentFilter)}},onHighlightFile:function ag(a2,a1){if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){this.viewRenderers[this.options.viewRendererName].onHighlightFile(this,a2,a1)}},onDeactivateAllControls:function V(a3,a2){var a1,a4=Alfresco.util.disableYUIButton;for(a1 in this.widgets){if(this.widgets.hasOwnProperty(a1)){a4(this.widgets[a1])}}},onDeactivateDynamicControls:function aq(a3,a2){var a1,a4=Alfresco.util.disableYUIButton;for(a1 in this.dynamicControls){if(this.dynamicControls.hasOwnProperty(a1)){a4(this.dynamicControls[a1])}}},onDeactivateSortControls:function aE(a3,a2){var a1,a4=Alfresco.util.disableYUIButton;for(a1 in this.sortControls){if(this.sortControls.hasOwnProperty(a1)){a4(this.sortControls[a1])}}},onActivateSortControls:function g(a3,a2){var a1,a4=Alfresco.util.enableYUIButton;for(a1 in this.sortControls){if(this.sortControls.hasOwnProperty(a1)){a4(this.sortControls[a1])}}},onActivateDynamicControls:function F(a3,a2){var a1,a4=Alfresco.util.enableYUIButton;for(a1 in this.dynamicControls){if(this.dynamicControls.hasOwnProperty(a1)){a4(this.dynamicControls[a1])}}},onLikes:function B(a7){var a4=a7;if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){a4=this.viewRenderers[this.options.viewRendererName].getDataTableRecordIdFromRowElement(this,a7)}var a8=this.widgets.dataTable.getRecord(a4),a5=a8.getData(),a6=a5.jsNode.nodeRef,a2=a5.likes;a2.isLiked=!a2.isLiked;a2.totalLikes+=(a2.isLiked?1:-1);var a9={successCallback:{fn:function a1(bg,bd){var bh=bg.json.data;if(bh){var bf=this._findRecordByParameter(bd,"nodeRef"),ba=bf.getData(),be=ba.node,bb=ba.likes;bb.totalLikes=bh.ratingsCount;this.widgets.dataTable.updateRow(bf,ba);if(bb.isLiked){var bc={fileName:ba.fileName,nodeRef:be.nodeRef};if(be.isContainer){this.modules.actions.postActivity(this.options.siteId,"folder-liked","folder-details",bc)}else{this.modules.actions.postActivity(this.options.siteId,"file-liked","document-details",bc)}}}},scope:this,obj:a6.toString()},failureCallback:{fn:function a3(be,bc){var bd=this._findRecordByParameter(bc,"nodeRef"),ba=bd.getData(),bb=ba.likes;bb.isLiked=!bb.isLiked;bb.totalLikes+=(bb.isLiked?1:-1);this.widgets.dataTable.updateRow(bd,ba);Alfresco.util.PopupManager.displayPrompt({text:this.msg("message.save.failure",ba.displayName)})},scope:this,obj:a6.toString()}};if(a2.isLiked){this.services.likes.set(a6,1,a9)}else{this.services.likes.remove(a6,a9)}this.widgets.dataTable.updateRow(a8,a5)},onFavourite:function ay(a7){var a4=a7;if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){a4=this.viewRenderers[this.options.viewRendererName].getDataTableRecordIdFromRowElement(this,a7)}var a8=this.widgets.dataTable.getRecord(a4),a5=a8.getData(),a3=a5.node,a6=a3.nodeRef;a5.isFavourite=!a5.isFavourite;this.widgets.dataTable.updateRow(a8,a5);var a2=a5.isFavourite?"favouriteDocumentOrFolder":"unFavouriteDocumentOrFolder";var a9={failureCallback:{fn:function a1(be,ba){var bd=this.widgets.dataTable.getRecord(ba),bb=bd.getData(),bc=bb.node;bb.isFavourite=!bb.isFavourite;this.widgets.dataTable.updateRow(bd,bb);Alfresco.util.PopupManager.displayPrompt({text:this.msg("message.save.failure",bb.displayName)})},scope:this,obj:a7}};this.services.preferences[a2].call(this.services.preferences,a3,a9)},onResizerChanged:function aN(){this._resizeRowContainers()},_resizeRowContainers:function al(a4){if(!YAHOO.lang.isNumber(a4)){var a1=z.get("alf-filters"),a5=(a1?parseInt(a1.style.width,10):160)+390,a4=(z.getViewportWidth()-a5)+"px"}else{a4=(a4-390)+"px"}var a2=YAHOO.util.Selector.query("h3.filename",this.id+"-documents");for(var a3=0;a3<a2.length;a3++){a2[a3].parentNode.style.width=a4}},_setDefaultDataTableErrors:function e(a1){var a2=Alfresco.util.message;a1.set("MSG_EMPTY",a2("message.empty","Alfresco.DocumentList"));a1.set("MSG_ERROR",a2("message.error","Alfresco.DocumentList"))},_updateDefaultViewOptions:function aw(a6){var a4=z.getElementsByClassName("removeDefaultView");var a5=null;if(a4.length>0){a5=a4[0].parentNode.parentNode}var a1=z.getElementsByClassName("setDefaultView");var a3=null;if(a1.length>0){a3=a1[0].parentNode.parentNode}if(this.options.userIsSiteManager||(this.doclistMetadata.parent.properties!=null&&this.doclistMetadata.parent.properties["cm:creator"].userName==Alfresco.constants.USERNAME)){if(this.doclistMetadata.parent.properties!=null&&this.doclistMetadata.parent.properties["app:defaultViewId"]!=null&&this.doclistMetadata.parent.properties["app:defaultViewId"]!=""){for(var a2=0;a2<this.options.viewRenderers.length;a2++){if(this.options.viewRenderers[a2].id==this.doclistMetadata.parent.properties["app:defaultViewId"]){a4[0].innerHTML=this.msg("button.removeDefaultView",this.options.viewRenderers[a2].label);break}}z.removeClass(a5,"hidden");if(this.doclistMetadata.parent.properties["app:defaultViewId"]==this.options.viewRendererName){z.addClass(a3,"hidden")}else{z.removeClass(a3,"hidden")}}else{z.removeClass(a3,"hidden");z.addClass(a5,"hidden")}}else{z.addClass(a3,"hidden");z.addClass(a5,"hidden")}if(a6){if(this.doclistMetadata.parent.properties&&this.doclistMetadata.parent.properties["app:defaultViewId"]!=null&&this.doclistMetadata.parent.properties["app:defaultViewId"]!=""){this.options.viewRendererName=this.doclistMetadata.parent.properties["app:defaultViewId"];z.addClass(a3,"hidden")}else{if(this.userPreferredView!=this.options.viewRendererName){this.options.viewRendererName=this.userPreferredView}}}for(var a2=0;a2<this.options.viewRenderers.length;a2++){if(this.options.viewRenderers[a2].id==this.options.viewRendererName){a1[0].innerHTML=this.msg("button.setDefaultView",this.options.viewRenderers[a2].label);break}}},_updateDocList:function aG(be){be=be||{};Alfresco.logger.debug("DL__updateDocList: ",be.filter,be.page);var bg=YAHOO.lang.merge({doclistFirstTimeNav:false},be.filter!==undefined?be.filter:this.currentFilter),a2=be.page!==undefined?be.page:this.currentPage,ba=null,a6=null,bc=this,a4={filter:bg,page:a2};var a7=function bb(){Alfresco.logger.debug("DL__uDL_fnShowLoadingMessage: slow data webscript detected.");if(a6){ba=Alfresco.util.PopupManager.displayMessage({displayTime:0,text:'<span class="wait">'+f(this.msg("message.loading"))+"</span>",noEscape:true});if(YAHOO.env.ua.ie>0){this.loadingMessageShowing=true}else{ba.showEvent.subscribe(function(){this.loadingMessageShowing=true},this,true)}}};this._setDefaultDataTableErrors(this.widgets.dataTable);this.previewTooltips=[];this.insituEditors=[];this.hideMoreActionsFn=null;this.loadingMessageShowing=false;a6=YAHOO.lang.later(this.options.loadingMessageDelay,this,a7);var bf=function a8(){if(a6){a6.cancel();a6=null}if(ba){if(this.loadingMessageShowing){ba.destroy();ba=null}else{YAHOO.lang.later(100,bc,bf)}}};var a9=function a3(bk,bm,bn){bf();var bh=function bi(){YAHOO.Bubbling.fire("activateDynamicControls");YAHOO.Bubbling.fire("selectedFilesChanged");this.listUpdated=false;if(this.currentFilter.filterId=="recentlyModified"||this.currentFilter.filterId=="recentlyAdded"){YAHOO.Bubbling.fire("deactivateSortControls")}else{YAHOO.Bubbling.fire("activateSortControls")}};this.afterDocListUpdate.push(bh);Alfresco.logger.debug("currentFilter was:",this.currentFilter,"now:",bg);Alfresco.logger.debug("currentPage was ["+this.currentPage+"] now ["+a2+"]");this.currentFilter=bg;this.currentPage=a2;var bo=false;if(bg.filterId==="path"){Alfresco.logger.debug("currentPath was ["+this.currentPath+"] now ["+bg.filterData+"]");bo=(this.currentPath!=bg.filterData);this.currentPath=bg.filterData}delete bg.doclistFirstTimeNav;YAHOO.Bubbling.fire("filterChanged",bg);this._updateDefaultViewOptions(bo);for(var bj=0,bl=this.options.viewRendererNames.length;bj<bl;bj++){if(typeof this.viewRenderers[this.options.viewRendererNames[bj]]==="object"){this.viewRenderers[this.options.viewRendererNames[bj]].destroyView(this,bk,bm,bn)}}if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){this.viewRenderers[this.options.viewRendererName].renderView(this,bk,bm,bn)}else{}};var a1=function a5(bh,bi){bf();this.afterDocListUpdate=[];if(bi.status===401){window.location.reload(true)}else{try{if(bi.status===404){YAHOO.Bubbling.fire("deactivateDynamicControls");YAHOO.Bubbling.fire("deactivateSortControls")}else{YAHOO.Bubbling.fire("deactivateAllControls")}var bl=function bj(bo,bn){return function bm(){this.widgets.paginator.setState({totalRecords:0});this.widgets.paginator.render();this.widgets.dataTable.set("MSG_ERROR",bo);if(bn===410){this.widgets.dataTable.showTableMessage(bo,YAHOO.widget.DataTable.CLASS_DISABLED)}else{this.widgets.dataTable.showTableMessage(bo,YAHOO.widget.DataTable.CLASS_ERROR)}}};this.afterDocListUpdate.push(bl(YAHOO.lang.JSON.parse(bi.responseText).message,bi.status));this.widgets.dataTable.initializeTable();this.widgets.dataTable.render();this.listUpdated=false}catch(bk){Alfresco.logger.error(bk);this._setDefaultDataTableErrors(this.widgets.dataTable)}}};if(a4.filter&&a4.filter.filterId==="path"){a4.path=a4.filter.filterData;if(this.currentFilter.filterData!=a4.path){Alfresco.logger.debug("currentFilter.filterData was ["+this.currentFilter.filterData+"] now ["+a4.path+"]");this.currentFilter.filterData=a4.path}}var bd=this._buildDocListParams(a4);Alfresco.logger.debug("DataSource requestParams: ",bd);this.widgets.dataSource.sendRequest(bd,{success:a9,failure:a1,scope:this})},_buildDocListParams:function a(a5){var a2=E(this.options.siteId),a3={path:this.currentPath,type:this.options.showFolders?"all":"documents",site:this.options.siteId,container:this.options.containerId,filter:this.currentFilter};if(this.options.usePagination){a3.page=this.widgets.paginator.getCurrentPage()||this.currentPage;a3.pageSize=this.widgets.paginator.getRowsPerPage()}if(typeof a5==="object"){a3=YAHOO.lang.merge(a3,a5)}var a1=a2?"site/{site}/{container}":"node/alfresco/company/home",a4=YAHOO.lang.substitute("{type}/"+a1+(a3.filter.filterId==="path"?"{path}":""),{type:encodeURIComponent(a3.type),site:encodeURIComponent(a3.site),container:encodeURIComponent(a3.container),path:aH("/",Alfresco.util.encodeURIPath(a3.path))});a4+="?filter="+encodeURIComponent(a3.filter.filterId);if(a3.filter.filterData&&a3.filter.filterId!=="path"){a4+="&filterData="+encodeURIComponent(a3.filter.filterData)}if(this.options.usePagination){a4+="&size="+a3.pageSize+"&pos="+a3.page}a4+="&sortAsc="+this.options.sortAscending+"&sortField="+encodeURIComponent(this.options.sortField);if(!a2){a4+="&libraryRoot="+encodeURIComponent(this.options.rootNode.toString())}a4+="&view="+this.actionsView+"&noCache="+new Date().getTime();return a4},_findRecordByParameter:function aJ(a7,a6){var a5=this.widgets.dataTable.getRecordSet(),a4,a1,a3,a2;for(a3=0,a2=a5.getLength();a3<a2;a3++){a4=a5.getRecord(a3);a1=a4.getData();if(a1[a6]===a7||(a1.node&&a1.node[a6]===a7)){return a4}}return null}},true)})();