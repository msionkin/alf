define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/Grid.html","alfresco/documentlibrary/views/layouts/_MultiItemRendererMixin","alfresco/core/Core","dojo/keys","dojo/_base/lang","dojo/_base/array","dojo/dom-construct","dojo/dom-geometry","dojo/query","dojo/dom-style","dijit/registry","dojo/dom","dojo/on"],function(t,a,p,w,x,j,l,y,f,e,s,c,o,g,r,h){return t([a,p,x,j],{cssRequirements:[{cssFile:"./css/Grid.css"}],templateString:w,columns:4,postCreate:function d(){this.inherited(arguments);if(this.widgets){this.processWidgets(this.widgets,this.containerNode)}h(window,"resize",y.hitch(this,"resizeCells"));this.alfSubscribe("ALF_NODE_RESIZED",y.hitch(this,"onNodeResized"))},setupKeyboardNavigation:function i(){this.connectKeyNavHandlers([l.LEFT_ARROW],[l.RIGHT_ARROW]);this._keyNavCodes[l.UP_ARROW]=y.hitch(this,"focusOnCellAbove");this._keyNavCodes[l.DOWN_ARROW]=y.hitch(this,"focusOnCellBelow")},focusOnCellAbove:function u(){var z=null;focusIndex=this.getIndexOfChild(this.focusedChild),focusColumn=(focusIndex%this.columns)+1,allChildren=this.getChildren(),childCount=this.getChildren().length;if(focusIndex-this.columns<0){var A=childCount%this.columns;if(A==0||A>=focusColumn){z=allChildren[childCount-(this.columns-focusColumn)+1]}else{z=allChildren[childCount-1]}}else{z=allChildren[focusIndex-this.columns]}this.focusChild(z)},focusOnCellBelow:function k(){var z=null;focusIndex=this.getIndexOfChild(this.focusedChild),focusColumn=(focusIndex%this.columns),allChildren=this.getChildren(),childCount=this.getChildren().length;if(focusIndex+this.columns>childCount){z=allChildren[focusColumn]}else{z=allChildren[focusIndex+this.columns]}this.focusChild(z)},onNodeResized:function v(z){if(r.isDescendant(this.domNode,z.node)){this.resizeCells()}},resizeCells:function q(){this.alfLog("info","Resizing");if(y.exists("containerNode.parentNode",this)&&this.containerNode.parentNode!=null){var z=s.getContentBox(this.containerNode.parentNode);var A=(Math.floor(z.w/this.columns)-4)+"px";c("tr > td",this.containerNode).forEach(y.hitch(this,"resizeCell",z,A))}},resizeCell:function n(D,C,B,z){o.set(B,{width:C});var A={w:C,h:null};f.forEach(B.children,y.hitch(this,"resizeWidget",A))},resizeWidget:function b(A,C,z){var B=g.byNode(C);if(B!=null&&typeof B.resize==="function"){B.resize(A)}},createWidgetDomNode:function m(E,B,A){var z=B;if(this.currentIndex%this.columns==0){var C=e.create("TR",{},B);z=e.create("TD",{},C)}else{var D=B.children[B.children.length-1];z=e.create("TD",{},D)}return e.create("DIV",{},z)}})});