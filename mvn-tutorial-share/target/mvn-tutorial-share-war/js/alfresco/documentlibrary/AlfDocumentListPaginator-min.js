define(["dojo/_base/declare","alfresco/menus/AlfMenuBar","alfresco/documentlibrary/_AlfDocumentListTopicMixin","dojo/_base/lang","dojo/_base/array","alfresco/menus/AlfMenuBarSelect","alfresco/menus/AlfMenuGroups","alfresco/menus/AlfMenuGroup","alfresco/menus/AlfCheckableMenuItem","dijit/registry","dojo/dom-class"],function(n,c,a,r,f,k,j,b,h,g,i){return n([c,a],{i18nRequirements:[{i18nFile:"./i18n/AlfDocumentListPaginator.properties"}],cssRequirements:[{cssFile:"./css/AlfDocumentListPaginator.css"}],documentsPerPage:25,totalDocuments:null,totalPages:null,currentPage:null,pageBackTopic:"ALF_PAGE_BACK",pageForwardTopic:"ALF_PAGE_FORWARD",postMixInProperties:function l(){this.alfSubscribe(this.documentsLoadedTopic,r.hitch(this,"onDocumentsLoaded"));this.alfSubscribe(this.docsPerpageSelectionTopic,r.hitch(this,"onDocumentsPerPageChange"));this.alfSubscribe(this.pageBackTopic,r.hitch(this,"onPageBack"));this.alfSubscribe(this.pageForwardTopic,r.hitch(this,"onPageForward"))},onDocumentsPerPageChange:function o(s){if(s&&s.value&&s.value!=this.documentsPerPage){this.documentsPerPage=s.value}},onPageBack:function m(s){this.currentPage--;this.alfPublish(this.pageSelectionTopic,{value:this.currentPage})},onPageForward:function d(s){this.currentPage++;this.alfPublish(this.pageSelectionTopic,{value:this.currentPage})},onDocumentsLoaded:function q(y){this.alfLog("log","New Documents Loaded",y);if(y!=null){if(y.totalDocuments!=null&&y.startIndex!=null){if(y.totalDocuments==0){i.add(this.domNode,"hidden")}else{i.remove(this.domNode,"hidden");this.totalDocuments=y.totalDocuments;this.totalPages=Math.ceil(y.totalDocuments/this.documentsPerPage);this.currentPage=((y.startIndex-(y.startIndex%this.documentsPerPage))/this.documentsPerPage)+1;if(this.pageBack){this.pageBack.set("disabled",(this.currentPage==1))}if(this.pageForward){this.pageForward.set("disabled",(this.currentPage==this.totalPages))}if(this.pageMarker){this.pageMarker.set("label",this.currentPage.toString());i.remove(this.pageMarker.domNode,"dijitDisabled dijitMenuItemDisabled")}if(this.pageSelectorGroup!=null){var z=this;f.forEach(this.pageSelectorGroup.getChildren(),function(B,A){z.pageSelectorGroup.removeChild(B);B.destroy()})}var w=[];var x=1;for(var t=0;t<this.totalPages;t++){var v;if(t+1!=this.totalPages){v=x+this.documentsPerPage-1}else{v=this.totalDocuments}var s=this.message("alf-documentlist-paginator.page.label",{0:x,1:v,2:this.totalDocuments});var u=new h({label:s,value:(t+1),group:"PAGE_SELECTION_GROUP",checked:(this.currentPage==t+1),publishTopic:this.pageSelectionTopic,publishPayload:{label:s,value:(t+1)}});this.pageSelectorGroup.addChild(u);w.push();x=v+1}}}}},pageSelector:null,pageSelectorGroup:null,postCreate:function p(){var v=this.message("alf-documentlist-paginator.perPage.label",{0:25}),u=this.message("alf-documentlist-paginator.perPage.label",{0:50}),t=this.message("alf-documentlist-paginator.perPage.label",{0:75}),s=this.message("alf-documentlist-paginator.perPage.label",{0:100});this.widgets=[{name:"alfresco/menus/AlfMenuBarSelect",config:{label:this.message("alf-documentlist-paginator.pageSelect.label"),selectionTopic:this.pageSelectionTopic,widgets:[{name:"alfresco/menus/AlfMenuGroup"}]},},{name:"alfresco/menus/AlfMenuBarItem",config:{id:this.id+"_PAGE_BACK",label:this.message("alf-documentlist-paginator.back.label"),publishTopic:this.pageBackTopic}},{name:"alfresco/menus/AlfMenuBarItem",config:{id:this.id+"_PAGE_MARKER",label:"1",disabled:true}},{name:"alfresco/menus/AlfMenuBarItem",config:{id:this.id+"_PAGE_FORWARD",label:this.message("alf-documentlist-paginator.next.label"),publishTopic:this.pageForwardTopic}},{name:"alfresco/menus/AlfMenuBarSelect",config:{label:this.message("alf-documentlist-paginator.docsPerPageSelect.label"),selectionTopic:this.docsPerpageSelectionTopic,minRwdWidth:1024,widgets:[{name:"alfresco/menus/AlfMenuGroup",config:{widgets:[{name:"alfresco/menus/AlfCheckableMenuItem",config:{label:v,value:25,group:"DOCUMENTS_PER_PAGE_GROUP",checked:(this.documentsPerPage==25),publishTopic:this.docsPerpageSelectionTopic,publishPayload:{label:v,value:25}}},{name:"alfresco/menus/AlfCheckableMenuItem",config:{label:u,value:50,group:"DOCUMENTS_PER_PAGE_GROUP",checked:(this.documentsPerPage==50),publishTopic:this.docsPerpageSelectionTopic,publishPayload:{label:u,value:50}}},{name:"alfresco/menus/AlfCheckableMenuItem",config:{label:t,value:75,group:"DOCUMENTS_PER_PAGE_GROUP",checked:(this.documentsPerPage==75),publishTopic:this.docsPerpageSelectionTopic,publishPayload:{label:t,value:75}}},{name:"alfresco/menus/AlfCheckableMenuItem",config:{label:s,value:100,group:"DOCUMENTS_PER_PAGE_GROUP",checked:(this.documentsPerPage==100),publishTopic:this.docsPerpageSelectionTopic,publishPayload:{label:s,value:100}}}]}}]}}];this.inherited(arguments)},allWidgetsProcessed:function e(){this.inherited(arguments);this.pageSelectorGroup=this._menuBar.getChildren()[0].popup.getChildren()[0];this.pageBack=g.byId(this.id+"_PAGE_BACK");this.pageForward=g.byId(this.id+"_PAGE_FORWARD");this.pageMarker=g.byId(this.id+"_PAGE_MARKER")}})});