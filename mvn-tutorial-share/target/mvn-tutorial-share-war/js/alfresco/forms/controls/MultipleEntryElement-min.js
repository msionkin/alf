define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/MultipleEntryElement.html","alfresco/core/Core","alfresco/forms/PublishForm","dojo/dom-class","alfresco/forms/controls/DojoValidationTextBox"],function(p,k,g,q,l,o,i,f){return p([k,g,l],{cssRequirements:[{cssFile:"./css/MultipleEntryElement.css"}],i18nRequirements:[{i18nFile:"./i18n/MultipleEntryElement.properties"}],templateString:q,id:null,elementConfig:null,constructor:function d(s){p.safeMixin(this,s);this.determineKeyAndValue()},determineKeyAndValue:function m(){this.alfLog("log","DetermineKeyAndValue",this);if(this.elementConfig!=null){if(this.elementConfig.fieldId==null||this.elementConfig.fieldId==""){this.elementConfig.fieldId=this.generateUuid()}this.fieldId=this.elementConfig.fieldId;this.elementValue=this.elementConfig}else{this.fieldId=this.generateUuid();this.elementValue={};this.elementValue.fieldId=this.fieldId}},postCreate:function r(){this.createReadDisplay()},createReadDisplay:function e(){var s=this.getValue();this.readDisplay.innerHTML=this.encodeHTML(s.value)},form:null,createEditDisplay:function h(){if(this.form==null){var s=this.generateUuid();this.form=new o({pubSubScope:s,dataScope:this.dataScope,widgets:this.getFormWidgets()});this.form.setValue(this.elementValue);this.alfLog("log","Created new form for MEE",this.form);this.form.placeAt(this.editDisplay)}this.form.validate()},getFormWidgets:function a(){return[{name:"alfresco/forms/controls/DojoValidationTextBox",config:{name:"fieldId",label:"fieldId",value:this.elementValue.fieldId,visibilityConfig:{initialValue:false}}},{name:"alfresco/forms/controls/DojoValidationTextBox",config:{name:"value",label:"multi.element.value.label",description:"multi.element.value.description",value:this.elementValue.value,requirementConfig:{initialValue:true}}}]},onElementValueChange:function j(t,s,u){this.elementValue.value=u;this.createReadDisplay()},editMode:function c(s){if(s){this.createEditDisplay();i.remove(this.editDisplay,"hide");i.add(this.readDisplay,"hide")}else{this.createReadDisplay();i.add(this.editDisplay,"hide");i.remove(this.readDisplay,"hide")}},getValue:function b(){var s={};if(this.form!=null){s=this.form.getValue()}else{s=this.elementValue}return s},validate:function n(){var s=true;if(this.form){s=this.form.validate()}return s}})});