define(["dojo/_base/declare","dojo/_base/lang","dijit/_WidgetBase","dijit/_OnDijitClickMixin","dijit/_TemplatedMixin","dojo/text!./templates/SearchBox.html","alfresco/core/Core","alfresco/header/AlfMenuBar","dojo/_base/fx","dojo/dom-attr","dojo/dom-construct","dojo/on"],function(f,a,j,c,p,m,b,g,e,k,d,i){return f([j,c,p,b],{i18nScope:"org.alfresco.SearchBox",cssRequirements:[{cssFile:"./css/SearchBox.css"}],i18nRequirements:[{i18nFile:"./i18n/SearchBox.properties"}],templateString:m,_searchMenu:null,_focusedWidth:"250",_blurredWidth:"100",site:null,advancedSearch:true,postCreate:function n(){var q=this;k.set(this._searchTextNode,"value",this.message("search.instruction"));i(this._searchTextNode,"keydown",function(r){q.onSearchBoxKeyDown(r)});if(this.advancedSearch){this._searchMenu=new g({widgets:[{name:"alfresco/header/AlfMenuBarPopup",config:{id:this.id+"_DROPDOWN_MENU",showArrow:false,label:"",iconClass:"alf-search-icon",widgets:[{name:"alfresco/menus/AlfMenuItem",config:{id:this.id+"_ADVANCED_SEARCH",i18nScope:"org.alfresco.SearchBox",label:"search.advanced",targetUrl:(Alfresco.constants.SITE!=""?"site/"+Alfresco.constants.SITE+"/":"")+"advsearch"}}]}}]});this._searchMenu.placeAt(this._searchMenuNode);this._searchMenu.startup()}},onSearchBoxKeyDown:function o(q){if(q.keyCode===13){var s=a.trim(this._searchTextNode.value);if(s.length!==0){this.alfLog("log","Search request for: ",s);var r="search?t="+encodeURIComponent(s);if(this.site!=null){r="site/"+this.site+"/"+r}this.alfPublish("ALF_NAVIGATE_TO_PAGE",{url:r,type:"SHARE_PAGE_RELATIVE",target:"CURRENT"})}}},onSearchNodeFocus:function l(){k.set(this._searchTextNode,"value","");this._searchTextNode.focus()},onSearchNodeBlur:function h(){k.set(this._searchTextNode,"value",this.message("search.instruction"))}})});