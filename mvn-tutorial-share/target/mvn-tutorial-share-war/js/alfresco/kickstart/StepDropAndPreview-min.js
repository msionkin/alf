define(["dojo/_base/declare","alfresco/creation/DropAndPreview","dojo/text!./templates/StepTemplate.html","dojo/_base/lang","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojo/string"],function(e,b,g,c,d,j,i,h){return e([b],{creator:function a(m,o){this.alfLog("log","Creating",m,o);if(m.data.module!=null&&m.data.module!=""){var n=c.clone(m);var k=(n.data.defaultConfig!=null)?n.data.defaultConfig:{};if(k.id===undefined){k.id=this.generateUuid()}if(k.fieldId===undefined){k.fieldId=k.id}if(k.pubSubScope===undefined){k.pubSubScope=k.id}this.alfSetData(k.id+".name",n.data.defaultConfig.stepTitle+"");this.alfSubscribe(k.pubSubScope+"ALF_REQUEST_AVAILABLE_FORM_FIELDS",c.hitch(this,"publishAvailableFields",k.pubSubScope),true);var l=[{name:n.data.module,assignTo:"lastCreatedNode",config:k}];this.processWidgets(l)}j.add(this.previewNode,"containsItems");return{node:this.lastCreatedNode.domNode,data:n,type:["widget"]}},publishAvailableFields:function f(k){var l={};l.options=this.getAvailableFields();this.alfLog("log","Publishing available fields:",l,this);this.alfPublish(k+"ALF_FORM_FIELDS_UPDATE",l,true)},})});