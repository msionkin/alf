define(["dojo/_base/declare","alfresco/menus/AlfMenuBarSelect","dojo/dom-class","dojo/_base/lang","dojo/on","dojo/_base/event"],function(e,d,k,b,i,a){return e([d],{iconClass:"alf-noneselected-icon",_NONE:0,_SOME:1,_ALL:2,_UNKNOWN:3,_itemsSelected:0,notificationTopic:"ALF_DOCLIST_FILE_SELECTION",postCreate:function l(){this.inherited(arguments);if(this.iconNode!=null){i(this.iconNode,"click",b.hitch(this,"handleIconClick"))}},handleIconClick:function c(n){this.alfLog("log","Icon node clicked");this.closePopupMenu();if(this._itemsSelected==this._NONE){this.renderAllSelected();this.alfPublish(this.notificationTopic,{value:"selectAll"})}else{if(this._itemsSelected==this._SOME){this.renderAllSelected();this.alfPublish(this.notificationTopic,{value:"selectAll"})}else{if(this._itemsSelected==this._ALL){this.renderNoneSelected();this.alfPublish(this.notificationTopic,{value:"selectNone"})}else{this.renderNoneSelected();this.alfPublish(this.notificationTopic,{value:"selectNone"})}}}a.stop(n);k.remove(this.domNode,"dijitMenuItemSelected")},handleSelection:function j(n){this.alfLog("log","Selection detected",n);if(n){if(n.value=="selectAll"){this.renderAllSelected()}else{if(n.value=="selectNone"){this.renderNoneSelected()}else{this.determineSelection(n)}}}k.remove(this.domNode,"dijitMenuItemSelected")},determineSelection:function g(n){if(n.availableItemCount!=null&&n.selectedItemCount!=null){if(n.selectedItemCount==0){this.renderNoneSelected()}else{if(n.availableItemCount>n.selectedItemCount){this.renderSomeSelected()}else{if(n.availableItemCount==n.selectedItemCount){this.renderAllSelected()}else{this.alfLog("warn","Couldn't work out how many were selected");this._itemsSelected=this._UNKNOWN}}}}},renderAllSelected:function m(){if(this.iconNode){k.remove(this.iconNode,this._currentIconClass);this._currentIconClass="alf-allselected-icon";k.add(this.iconNode,this._currentIconClass)}this._itemsSelected=this._ALL},renderSomeSelected:function f(){if(this.iconNode){k.remove(this.iconNode,this._currentIconClass);this._currentIconClass="alf-someselected-icon";k.add(this.iconNode,this._currentIconClass)}this._itemsSelected=this._SOME},renderNoneSelected:function h(){if(this.iconNode){k.remove(this.iconNode,this._currentIconClass);this._currentIconClass="alf-noneselected-icon";k.add(this.iconNode,this._currentIconClass)}this._itemsSelected=this._NONE}})});