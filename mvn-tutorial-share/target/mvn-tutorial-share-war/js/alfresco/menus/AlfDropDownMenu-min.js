define(["dojo/_base/declare","dijit/DropDownMenu","alfresco/core/Core","alfresco/menus/AlfMenuItemWrapper","dojo/_base/array","dojo/dom-class","dojo/_base/event","dojo/on"],function(f,m,d,o,i,l,b,j){return f([m,d],{cssRequirements:[{cssFile:"./css/AlfDropDownMenu.css"}],postCreate:function h(){this.inherited(arguments);l.add(this.containerNode.parentNode,"alf-dropdown-menu");if(this.widgets){this.processWidgets(this.widgets)}},allWidgetsProcessed:function c(p){var q=this;i.forEach(p,function(s,r){q.addChild(s)})},addChild:function a(r,p){if(r.domNode.tagName.toUpperCase()!="TR"){var q=new o({pubSubScope:r.pubSubScope,item:r});this.inherited(arguments,[q,p])}else{this.inherited(arguments)}this.setFirstAndLastMarkerClasses()},focusNext:function n(){var q=this.getParent();if(l.contains(this.focusedChild.domNode,"last-focusable-entry")){this.alfLog("log","Focus first in next group");var p=q._getSiblingOfChild(this,1);while(p&&!p.hasChildren()){p=q._getSiblingOfChild(p,1)}if(p){p.focusFirstChild()}else{q._getFirstFocusableChild().focusFirstChild()}}else{this.alfLog("log","Focus next in current group");this.inherited(arguments)}},focusPrev:function k(){var q=this.getParent();if(l.contains(this.focusedChild.domNode,"first-focusable-entry")){this.alfLog("log","Focus last in previous group");var p=q._getSiblingOfChild(this,-1);while(p&&!p.hasChildren()){p=q._getSiblingOfChild(p,-1)}if(p){p.focusLastChild()}else{q._getLastFocusableChild().focusLastChild()}}else{this.alfLog("log","Focus previous in group");this.inherited(arguments)}},removeChild:function g(p){this.inherited(arguments);this.setFirstAndLastMarkerClasses()},setFirstAndLastMarkerClasses:function e(){var s=this.getChildren().length;if(s>0){i.forEach(this.getChildren(),function(u,t){l.remove(u.domNode,"first-focusable-entry");l.remove(u.domNode,"last-focusable-entry")});i.some(this.getChildren(),function(t){if(t.isFocusable()){l.add(t.domNode,"first-focusable-entry");return true}});var q=s-1,r=this.getChildren(),p=false;while(q>=0&&!p){if(r[q].isFocusable()){l.add(r[q].domNode,"last-focusable-entry");p=true}q--}l.add(r[0].domNode,"first-entry");l.add(r[s-1].domNode,"last-entry")}}})});