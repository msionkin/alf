define(["dojo/_base/declare","alfresco/menus/AlfMenuItem","dojo/_base/lang","dojo/_base/event","dojo/dom-construct","dojo/dom-class","dojo/dom-style"],function(h,e,d,a,f,l,j){return h([e],{cssRequirements:[{cssFile:"./css/AlfCheckableMenuItem.css"}],checkCell:null,checked:false,checkedIconClass:"alf-selected-icon",group:null,publishPayload:null,subscriptionHandle:null,postCreate:function c(){if(this.publishPayload==null){this.publishPayload={}}this.alfLog("log","Create checkable cell");this.checkCell=f.create("td",{className:"alf-checkable-menu-item",innerHTML:"&nbsp;"},this.focusNode,"first");if(this.checked){l.add(this.checkCell,this.checkedIconClass)}if(this.group){this.alfSubscribe("ALF_CHECKABLE_MENU_ITEM__"+this.group,d.hitch(this,"onGroupSelection"))}this.inherited(arguments);if(this.checked){this.publishSelection()}if(this.publishTopic){this.subscriptionHandle=this.alfSubscribe(this.publishTopic,d.hitch(this,"onPublishTopicEvent"))}},onPublishTopicEvent:function i(n){if(n&&n.selected!=null&&n.value==this.value){if(this.group){this.alfPublish("ALF_CHECKABLE_MENU_ITEM__"+this.group,{});this.checked=n.selected}else{this.checked=n.selected}this.render()}},closeOnClick:true,onClick:function k(n){this.emitClosePopupEvent();this.toggleSelection(n)},toggleSelection:function g(n){this.alfLog("log","Toggle selection");a.stop(n);if(this.group){if(!this.checked){this.alfPublish("ALF_CHECKABLE_MENU_ITEM__"+this.group,{});this.checked=true;this.render();this.publishSelection()}}else{this.checked=!this.checked;this.render();this.publishSelection()}l.remove(this.checkCell.parentNode,"dijitMenuItemSelected")},render:function b(){if(this.checked){l.add(this.checkCell,this.checkedIconClass)}else{l.remove(this.checkCell,this.checkedIconClass)}},publishSelection:function m(){this.alfLog("log","Publishing selection",this.publishTopic,this.value,this.checked);if(this.publishTopic){this.publishPayload.selected=this.checked;this.publishPayload.value=this.value;this.alfPublish(this.publishTopic,this.publishPayload)}},onGroupSelection:function g(n){this.checked=false;this.render()}})});