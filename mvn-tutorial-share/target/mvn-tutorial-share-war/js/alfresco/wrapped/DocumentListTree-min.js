define(["dojo/_base/declare","alfresco/core/WrappedShareWidget","dijit/_TemplatedMixin","dojo/text!./templates/DocumentListTree.html","alfresco/documentlibrary/_AlfDocumentListTopicMixin","dojo/_base/lang","dojo/dom","dojo/dom-construct","dojo/dom-style"],function(i,h,n,l,f,c,g,d,k){return i([h,n,f],{cssRequirements:[{cssFile:"/components/documentlibrary/tree.css"},{cssFile:"./css/DocumentListTree.css"}],i18nScope:"Alfresco.DocListTree",i18nRequirements:[{i18nFile:"/WEB-INF/classes/alfresco/site-webscripts/org/alfresco/components/documentlibrary/tree.get.properties"}],templateString:l,nonAmdDependencies:["/components/documentlibrary/tree.js","/components/documentlibrary/repo-tree.js"],templateMessages:null,constructor:function e(o){i.safeMixin(this,o);this.templateMessages={header_library:this.message("header.library")}},siteId:null,containerId:null,postCreate:function a(){YAHOO.Bubbling.on("metadataRefresh",this.onLegacyMetadataRefresh,this);YAHOO.Bubbling.on("changeFilter",this.onLegacyChangeFilter,this);this.alfSubscribe(this.filterChangeTopic,c.hitch(this,"onFilterChanged"));if(this.siteId==null){this._tree=new Alfresco.RepositoryDocListTree(this.id).setOptions({rootNode:this.rootNode,evaluateChildFolders:this.evaluateChildFolders,maximumFolderCount:this.maximumFolderCount,setDropTargets:this.setDropTargets})}else{this._tree=new Alfresco.DocListTree(this.id).setOptions({siteId:this.siteId,containerId:this.containerId,evaluateChildFolders:this.evaluateChildFolders,maximumFolderCount:this.maximumFolderCount,setDropTargets:this.setDropTargets})}},onLegacyMetadataRefresh:function j(p,o){this.alfPublish(this.reloadDataTopic,{})},onLegacyChangeFilter:function m(p,o){var q=o[1];if(q!=null&&q.filterId&&q.filterData){this.alfPublish("ALF_NAVIGATE_TO_PAGE",{url:"filter="+q.filterId+"|"+q.filterData+"|",type:"HASH"})}},onFilterChanged:function b(o){this.alfLog("log","Filter change detected",o);if(o!=null){this.alfLog("info","Updating DocumentListTree with new filter:",o);YAHOO.Bubbling.fire("filterChanged",o)}else{this.alfLog("warn","The current filter matches the published change:",this._currentFilter,o)}}})});