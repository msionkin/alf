define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","alfresco/renderers/_JsNodeMixin","alfresco/node/DraggableNodeMixin","alfresco/node/NodeDropTargetMixin","dojo/text!./templates/Thumbnail.html","alfresco/core/Core","alfresco/renderers/_ItemLinkMixin","alfresco/documentlibrary/_AlfDndDocumentUploadMixin"],function(e,h,n,k,a,f,m,c,b,g){return e([h,n,k,a,f,c,b,g],{cssRequirements:[{cssFile:"./css/Thumbnail.css"}],templateString:m,customClasses:"",postMixInProperties:function l(){if(this.currentItem!=null&&this.currentItem.node){var p=this.currentItem.jsNode;var o=this.generateFileFolderLink();this.itemLinkHref=o.itemLinkHref+o.itemLinkRelative;this.itemLinkClass=o.itemLinkClass;this.itemLinkRelative=o.itemLinkRelative;this.thumbnailUrl=this.generateThumbnailUrl();this.imgTitle=this.encodeHTML(this.currentItem.displayName);this.imgAltText=(this.currentItem.displayName!=null)?this.currentItem.displayName.substring(this.currentItem.displayName.lastIndexOf(".")):"";this.imgId=p.nodeRef.nodeRef}},getFolderImage:function d(){return Alfresco.constants.URL_RESCONTEXT+"components/documentlibrary/images/folder-64.png"},renditionName:"doclib",generateThumbnailUrl:function j(){var o=null;if(this.renditionName==null){this.renditionName="doclib"}if(this.currentItem!=null&&this.currentItem.node){var r=this.currentItem.jsNode;if(r.isContainer||(r.isLink&&r.linkedNode.isContainer)){o=this.getFolderImage()}else{var q=r.isLink?r.linkedNode.nodeRef:r.nodeRef;if(r.properties["cm:lastThumbnailModification"]){var s=r.properties["cm:lastThumbnailModification"];for(var p=0;p<s.length;p++){if(s[p].indexOf(this.renditionName)!=-1){o=Alfresco.constants.PROXY_URI+"api/node/"+q.uri+"/content/thumbnails/"+this.renditionName+"?c=queue&ph=true&lastModified="+s[p];break}}}}}if(o==null){o=Alfresco.constants.PROXY_URI+"api/node/"+q.uri+"/content/thumbnails/"+this.renditionName+"?c=queue&ph=true"}return o},postCreate:function i(){this.inherited(arguments);if(this.currentItem.jsNode.isContainer){this.addUploadDragAndDrop(this.imgNode);this.addNodeDropTarget(this.imgNode)}}})});