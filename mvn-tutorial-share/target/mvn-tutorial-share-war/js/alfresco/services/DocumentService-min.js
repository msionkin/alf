define(["dojo/_base/declare","alfresco/core/Core","alfresco/core/CoreXhr","alfresco/core/PathUtils","dojo/_base/lang","dojo/hash"],function(c,e,d,h,g,f){return c([e,d,h],{constructor:function b(i){g.mixin(this,i);this.alfSubscribe("ALF_RETRIEVE_DOCUMENTS_REQUEST",g.hitch(this,"onRetrieveDocumentsRequest"))},onRetrieveDocumentsRequest:function a(m){var i=(m.site!=null&&m.site!="")?"{type}/site/{site}/{container}":"{type}/node/alfresco/company/home";if(m.filter!=null&&m.filter.filterId==="path"){var l=encodeURIComponent(m.filter.filterData).replace(/%2F/g,"/").replace(/%25/g,"%2525");i+=this.combinePaths("/",l)}var n=g.replace(i,{type:encodeURIComponent(m.type),site:encodeURIComponent(m.site),container:encodeURIComponent(m.container)});if(m.filter!=null){n+="?filter="+encodeURIComponent(m.filter.filterId);if(m.filter.filterData&&m.filter.filterId!=="path"){n+="&filterData="+encodeURIComponent(m.filter.filterData)}}if(m.pageSize!=null&&m.page!=null){n+="&size="+m.pageSize+"&pos="+m.page}n+="&sortAsc="+m.sortAscending+"&sortField="+encodeURIComponent(m.sortField);if(m.site==null){n+="&libraryRoot="+encodeURIComponent(m.rootNode)}n+="&view=browse&noCache="+new Date().getTime();var k=Alfresco.constants.URL_SERVICECONTEXT+"components/documentlibrary/data/doclist/"+n;var j={alfTopic:"ALF_RETRIEVE_DOCUMENTS_REQUEST",url:k,method:"GET",callbackScope:this};this.serviceXhr(j)}})});