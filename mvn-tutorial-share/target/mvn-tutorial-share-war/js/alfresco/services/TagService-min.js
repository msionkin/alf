define(["dojo/_base/declare","alfresco/core/Core","alfresco/core/CoreXhr","alfresco/services/_TagServiceTopics","dojo/_base/lang"],function(c,e,f,a,g){return c([e,f],{siteId:null,containerId:null,rootNode:null,constructor:function b(h){g.mixin(this,h);this.alfSubscribe(a.tagQueryTopic,g.hitch(this,"onTagQuery"))},onTagQuery:function d(j){if(j==null||typeof j.callback!=="function"||j.callbackScope==null){this.alfLog("warn","A request was made for site tag data, but one or more of the following attributes was not provided: 'callback', 'callbackScope':",j)}else{var l=(j.maxTags!=null)?j.maxTags:100;var k=new Date().getTime();var i=null;if(this.siteId!=null&&this.containerId!=null){i=Alfresco.constants.PROXY_URI+"api/tagscopes/site/"+this.siteId+"/"+this.containerId+"/tags?d="+k+"&topN="+l}else{if(this.rootNode!=null){Alfresco.constants.PROXY_URI+"collaboration/tagQuery?d="+k+"&m="+l+"&s=count&n="+encodeURIComponent(this.rootNode)}else{this.alfLog("warn","It is not possible to retrieve tags without a 'siteId' and 'containerId' or a 'rootNode' attribute set on the tag service",this)}}if(i!=null){var h={url:i,method:"GET",successCallback:j.callback,callbackScope:j.callbackScope};this.serviceXhr(h)}}}})});