define(["dojo/_base/declare","alfresco/core/Core","alfresco/core/CoreXhr","alfresco/services/_PageServiceTopicMixin","alfresco/core/NotificationUtils","dojo/request/xhr","dojo/_base/lang"],function(l,g,i,f,h,p,e){return l([g,i,f,h],{i18nRequirements:[{i18nFile:"./i18n/PageService.properties"}],constructor:function c(r){e.mixin(this,r);this.alfSubscribe(this.availablePagesRequestTopic,e.hitch(this,"loadPages"));this.alfSubscribe(this.createPageTopic,e.hitch(this,"createPage"));this.alfSubscribe(this.updatePageTopic,e.hitch(this,"updatePage"))},loadPages:function n(){this.serviceXhr({url:Alfresco.constants.PROXY_URI+"/remote-share/pages",method:"GET",successCallback:this.pageCreateSuccess,failureCallback:this.pageCreateFailure,callbackScope:this})},loadPagesSuccess:function q(s,r){this.alfPublish(this.availablePagesTopic,{response:s,originalRequestConfig:r})},loadPagesFailure:function j(s,r){this.availablePagesLoadFailure(this.availablePagesTopic,{response:s,originalRequestConfig:r})},createPage:function k(s){if(s!=null&&s.pageDefinition!=null&&s.pageName!=null){var r={name:s.pageName,json:s.pageDefinition};this.serviceXhr({url:Alfresco.constants.PROXY_URI+"remote-share/page-definition",data:r,method:"POST",successCallback:this.pageCreateSuccess,failureCallback:this.pageCreateFailure,callbackScope:this})}else{this.alfLog("warn","A request was made to save a page definition to the repository but not enough information was provided",s)}},pageCreateSuccess:function d(s,r){this.alfLog("log","Successfully created page",s,r);this.displayMessage(this.message("page.creation.success",[r.data.name]));this.alfPublish(this.createPageSuccessTopic,{response:s,originalRequestConfig:r})},pageCreateFailure:function m(s,r){this.alfLog("error","Failed to create page",s,r);this.displayMessage(this.message("page.creation.failure",[r.data.name]));this.alfPublish(this.createPageFailureTopic,{response:s,originalRequestConfig:r})},updatePage:function b(s){if(s!=null&&s.pageDefinition!=null&&s.pageName!=null){var r={name:s.pageName,json:s.pageDefinition};this.serviceXhr({url:Alfresco.constants.PROXY_URI+"remote-share/page-definition/"+s.pageName,data:r,method:"PUT",successCallback:this.pageUpdateSuccess,failureCallback:this.pageUpdateFailure,callbackScope:this})}else{this.alfLog("warn","A request was made to update a page definition to the repository but not enough information was provided",s)}},pageUpdateSuccess:function o(s,r){this.alfLog("log","Successfully updated page",s,r);this.displayMessage(this.message("page.update.success",[r.data.name]));this.alfPublish(this.updatePageSuccessTopic,{response:s,originalRequestConfig:r})},pageUpdateFailure:function a(s,r){this.alfLog("error","Failed to update page",s,r);this.displayMessage(this.message("page.update.failure",[r.data.name]));this.alfPublish(this.updatePageFailureTopic,{response:s,originalRequestConfig:r})}})});